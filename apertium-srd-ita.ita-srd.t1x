<?xml version="1.0" encoding="UTF-8"?>
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
       <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="nom_pl">
       <cat-item tags="n.*.pl"/>
       <cat-item tags="n.*.sp"/>
    </def-cat>
    <def-cat n="nom_pl_mila">
       <cat-item tags="n.*.pl"/>
       <cat-item tags="n.*.sp"/>
       <cat-item lemma="mila" tags="num.*"/>
    </def-cat>
    <def-cat n="np">
       <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="np_unk">
       <cat-item tags="np.*"/>
       <cat-item tags=""/>
    </def-cat>
    <def-cat n="det">
       <cat-item tags="det.*"/>
    </def-cat>
    <def-cat n="detdef">
       <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="detdefmf">
       <cat-item tags="det.def.mf.*"/>
    </def-cat>
    <def-cat n="det_laprn">
       <cat-item tags="det.*"/>
       <cat-item lemma="lo" tags="prn.pro.p3.f.*"/> <!-- to avoid problems in disambiguation -->
    </def-cat>
    <def-cat n="det_num">
       <cat-item tags="det.*"/>
       <cat-item tags="num"/>
       <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="predet">
       <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="num">
       <cat-item tags="num"/>
       <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="verb">
       <cat-item tags="vbmod.*"/>
       <cat-item tags="vbser.*"/>
       <cat-item tags="vbhaver.*"/>
       <cat-item tags="vblex.*"/>
    </def-cat>
    <def-cat n="verb-tmp-srd">	<!-- verb amb els temps verbals del sard (sense cni, ifi, fti -->
       <cat-item tags="vblex.pri.*"/>
       <cat-item tags="vblex.prs.*"/>
       <cat-item tags="vblex.pii.*"/>
       <cat-item tags="vblex.pis.*"/>
       <cat-item tags="vblex.imp.*"/>
       <cat-item tags="vblex.inf"/>
       <cat-item tags="vblex.ger"/>
       <cat-item tags="vblex.pp.*"/>
       <cat-item tags="vbmod.pri.*"/>
       <cat-item tags="vbmod.prs.*"/>
       <cat-item tags="vbmod.pii.*"/>
       <cat-item tags="vbmod.pis.*"/>
       <cat-item tags="vbmod.imp.*"/>
       <cat-item tags="vbmod.inf"/>
       <cat-item tags="vbmod.ger"/>
       <cat-item tags="vbmod.pp.*"/>
       <cat-item tags="vbser.pri.*"/>
       <cat-item tags="vbser.prs.*"/>
       <cat-item tags="vbser.pii.*"/>
       <cat-item tags="vbser.pis.*"/>
       <cat-item tags="vbser.imp.*"/>
       <cat-item tags="vbser.inf"/>
       <cat-item tags="vbser.ger"/>
       <cat-item tags="vbser.pp.*"/>
       <cat-item tags="vbhaver.pri.*"/>
       <cat-item tags="vbhaver.prs.*"/>
       <cat-item tags="vbhaver.pii.*"/>
       <cat-item tags="vbhaver.pis.*"/>
       <cat-item tags="vbhaver.imp.*"/>
       <cat-item tags="vbhaver.inf"/>
       <cat-item tags="vbhaver.ger"/>
       <cat-item tags="vbhaver.pp.*"/>
    </def-cat>
    <def-cat n="vbmod">
       <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="vbmod-inf">
       <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="vbmod-tmp-srd">
       <cat-item tags="vbmod.inf"/>
       <cat-item tags="vbmod.pri.*"/>
       <cat-item tags="vbmod.prs.*"/>
       <cat-item tags="vbmod.pii.*"/>
       <cat-item tags="vbmod.pis.*"/>
       <cat-item tags="vbmod.imp.*"/>
    </def-cat>
    <def-cat n="vbmod-cni">
       <cat-item tags="vbmod.cni.*"/>
    </def-cat>
    <def-cat n="vbmod-ifi">
       <cat-item tags="vbmod.ifi.*"/>
    </def-cat>
    <def-cat n="vbmod-fti">
       <cat-item tags="vbmod.fti.*"/>
    </def-cat>
    <def-cat n="potere-vbmod-tmp-srd">
       <cat-item lemma="potere" tags="vbmod.pri.*"/>
       <cat-item lemma="potere" tags="vbmod.prs.*"/>
       <cat-item lemma="potere" tags="vbmod.pii.*"/>
       <cat-item lemma="potere" tags="vbmod.pis.*"/>
       <cat-item lemma="potere" tags="vbmod.imp.*"/>
    </def-cat>
    <def-cat n="potere-vbmod-cni">
       <cat-item lemma="potere" tags="vbmod.cni.*"/>
    </def-cat>
    <def-cat n="potere-vbmod-ifi">
       <cat-item lemma="potere" tags="vbmod.ifi.*"/>
    </def-cat>
    <def-cat n="potere-vbmod-fti">
       <cat-item lemma="potere" tags="vbmod.fti.*"/>
    </def-cat>
    <def-cat n="vblex_inf">
       <cat-item tags="vblex.inf"/>
    </def-cat>
    <def-cat n="inf">
       <cat-item tags="vbmod.inf"/>
       <cat-item tags="vbser.inf"/>
       <cat-item tags="vbhaver.inf"/>
       <cat-item tags="vblex.inf"/>
    </def-cat>
    <def-cat n="fti">
       <cat-item tags="vbmod.fti.*"/>
       <cat-item tags="vbser.fti.*"/>
       <cat-item tags="vbhaver.fti.*"/>
       <cat-item tags="vblex.fti.*"/>
    </def-cat>
    <def-cat n="cni">
       <cat-item tags="vbmod.cni.*"/>
       <cat-item tags="vbser.cni.*"/>
       <cat-item tags="vbhaver.cni.*"/>
       <cat-item tags="vblex.cni.*"/>
    </def-cat>
    <def-cat n="ifi">
       <cat-item tags="vbmod.ifi.*"/>
       <cat-item tags="vbhaver.ifi.*"/>
       <cat-item tags="vblex.ifi.*"/>
       <cat-item tags="vbser.ifi.*"/>
    </def-cat>
    <def-cat n="ifi_novbser">
       <cat-item tags="vbmod.ifi.*"/>
       <cat-item tags="vbhaver.ifi.*"/>
       <cat-item tags="vblex.ifi.*"/>
    </def-cat>
    <def-cat n="vbser_ifi">
       <cat-item tags="vbser.ifi.*"/>
    </def-cat>
    <def-cat n="ger">
       <cat-item tags="vblex.ger"/>
       <cat-item tags="vbmod.ger"/>
       <cat-item tags="vbser.ger"/>
       <cat-item tags="vbhaver.ger"/>
    </def-cat>
    <def-cat n="imper-ger-pp">
       <cat-item tags="vblex.imp.*"/>
       <cat-item tags="vblex.ger"/>
       <cat-item tags="vblex.pp"/>
       <cat-item tags="vbmod.imp.*"/>
       <cat-item tags="vbmod.ger"/>
       <cat-item tags="vbmod.pp"/>
       <cat-item tags="vbser.imp.*"/>
       <cat-item tags="vbser.ger"/>
       <cat-item tags="vbser.pp"/>
       <cat-item tags="vbhaver.imp.*"/>
       <cat-item tags="vbhaver.ger"/>
       <cat-item tags="vbhaver.pp"/>
    </def-cat>
    <def-cat n="pp">
       <cat-item tags="vbmod.pp.*"/>
       <cat-item tags="vbser.pp.*"/>
       <cat-item tags="vbhaver.pp.*"/>
       <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="pprs">
       <cat-item tags="vbmod.pprs.*"/>
       <cat-item tags="vbser.pprs.*"/>
       <cat-item tags="vbhaver.pprs.*"/>
       <cat-item tags="vblex.pprs.*"/>
    </def-cat>
    <def-cat n="imper">
       <cat-item tags="vbmod.imp.*"/>
       <cat-item tags="vbser.imp.*"/>
       <cat-item tags="vbhaver.imp.*"/>
       <cat-item tags="vblex.imp.*"/>
    </def-cat>
    <def-cat n="essere">
       <cat-item lemma="essere" tags="vbser.*"/>
    </def-cat>
    <def-cat n="essere-p3">
       <cat-item lemma="essere" tags="vbser.*.p3.*"/>
    </def-cat>
    <def-cat n="essere-ifi">
       <cat-item lemma="essere" tags="vbser.ifi.*"/>
    </def-cat>
    <def-cat n="essere-fti">
       <cat-item lemma="essere" tags="vbser.fti.*"/>
    </def-cat>
    <def-cat n="essere-cni">
       <cat-item lemma="essere" tags="vbser.cni.*"/>
    </def-cat>
    <def-cat n="essere-pp">
       <cat-item lemma="essere" tags="vbser.pp.*"/>
       <cat-item lemma="stare" tags="vblex.pp.*"/> <!-- possible error del parser -->
    </def-cat>
    <def-cat n="stare">
       <cat-item lemma="stare" tags="vblex.*"/>
    </def-cat>
    <def-cat n="prn">
       <cat-item tags="prn.*"/>
    </def-cat>
    <def-cat n="tn">
       <cat-item tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="tn-pers">
       <cat-item tags="prn.tn.p1.*"/>
       <cat-item tags="prn.tn.p2.*"/>
       <cat-item tags="prn.tn.p3.*"/>
       <cat-item tags="prn.pro.p3.mf.pl"/> <!-- acceptem aquest error del parser (però per alguna raó no ho està agafant)-->
    </def-cat>
    <def-cat n="pro">
       <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="pro-pers">
       <cat-item tags="prn.pro.p1.*"/>
       <cat-item tags="prn.pro.p2.*"/>
       <cat-item tags="prn.pro.p3.*"/>
    </def-cat>
    <def-cat n="gli">
       <cat-item lemma= "gli" tags="prn.pro.p3.m.sg"/>
    </def-cat>
    <def-cat n="loro_pro">
       <cat-item lemma= "gli" tags="prn.pro.p3.mf.pl"/>
    </def-cat>
    <def-cat n="ci">
       <cat-item lemma= "ci" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="enc">
       <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="enc-p3">
       <cat-item tags="prn.enc.p3.*"/>
    </def-cat>
    <def-cat n="si-enc">
       <cat-item lemma="si" tags="prn.enc.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="si-pro">
       <cat-item lemma="si" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="lo-enc">
       <cat-item lemma="lo" tags="prn.enc.p3.*"/>
    </def-cat>
    <def-cat n="adj">
       <cat-item tags="adj.*"/>
       <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adj_pl">
       <cat-item tags="adj.*.pl"/>
       <cat-item tags="adj.*.sp"/>
    </def-cat>
    <def-cat n="adjec">
       <cat-item tags="adj.m.*"/> <!-- Hem d'especificar el gènere perquè no coincidesca amb adj.pos, adj.sup, adj.ind etc. -->
       <cat-item tags="adj.f.*"/>
       <cat-item tags="adj.mf.*"/>
       <cat-item tags="adj.ind.m.*"/>
       <cat-item tags="adj.ind.f.*"/>
       <cat-item tags="adj.ind.mf.*"/>
       <cat-item tags="adj.itg.m.*"/>
       <cat-item tags="adj.itg.f.*"/>
       <cat-item tags="adj.itg.mf.*"/>
<!--       <cat-item tags="adj.ord.*"/> -->
       <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adjec-nopp">
       <cat-item tags="adj.m.*"/> <!-- Hem d'especificar el gènere perquè no coincidesca amb adj.pos, adj.sup, adj.ind etc. -->
       <cat-item tags="adj.f.*"/>
       <cat-item tags="adj.mf.*"/>
       <cat-item tags="adj.ind.m.*"/>
       <cat-item tags="adj.ind.f.*"/>
       <cat-item tags="adj.ind.mf.*"/>
       <cat-item tags="adj.itg.m.*"/>
       <cat-item tags="adj.itg.f.*"/>
       <cat-item tags="adj.itg.mf.*"/>
<!--       <cat-item tags="adj.ord.*"/> -->
    </def-cat>
    <def-cat n="meglio">
       <cat-item lemma="meglio" tags="adj.*"/>
    </def-cat>
    <def-cat n="adjec-adv">
       <cat-item tags="adj.m.*"/> <!-- Hem d'especificar el gènere perquè no coincidesca amb adj.pos, adj.sup, adj.ind etc. -->
       <cat-item tags="adj.f.*"/>
       <cat-item tags="adj.mf.*"/>
       <cat-item tags="adj.ind.m.*"/>
       <cat-item tags="adj.ind.f.*"/>
       <cat-item tags="adj.ind.mf.*"/>
       <cat-item tags="adj.itg.m.*"/>
       <cat-item tags="adj.itg.f.*"/>
       <cat-item tags="adj.itg.mf.*"/>
<!--       <cat-item tags="adj.ord.*"/> -->
       <cat-item tags="vblex.pp.*"/>
       <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="adjsup">
       <cat-item tags="adj.sup.*"/>
       <cat-item tags="adj.ind.sup.*"/>
    </def-cat>
    <def-cat n="adjpos">
       <cat-item tags="adj.pos.*"/>
    </def-cat>
    <def-cat n="loro_pos">
       <cat-item lemma="loro" tags="adj.pos.*"/>
       <cat-item lemma="loro" tags="prn.tn.pos.*"/>
       <cat-item lemma="lui" tags="prn.tn.p3.mf.pl"/>	<!-- per agafar anàlisis equivocades -->
    </def-cat>
    <def-cat n="adjord">
       <cat-item tags="adj.ord.*"/>
    </def-cat>
    <def-cat n="adv">
       <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="adv-preadv">
       <cat-item tags="adv"/>
       <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="rel">
       <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="pr">
       <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="a">
       <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="da">
       <cat-item lemma="da" tags="pr"/>
    </def-cat>
    <def-cat n="a_da">
       <cat-item lemma="a" tags="pr"/>
       <cat-item lemma="da" tags="pr"/>
    </def-cat>
    <def-cat n="a_in">
       <cat-item lemma="a" tags="pr"/>
       <cat-item lemma="in" tags="pr"/>
    </def-cat>
    <def-cat n="di">
       <cat-item lemma="di" tags="pr"/>
    </def-cat>
    <def-cat n="in">
       <cat-item lemma="in" tags="pr"/>
    </def-cat>
    <def-cat n="per">
       <cat-item lemma="per" tags="pr"/>
    </def-cat>
    <def-cat n="su">
       <cat-item lemma="su" tags="pr"/>
    </def-cat>
    <def-cat n="tutto_predet">
       <cat-item lemma="tutto" tags="predet.*"/>
    </def-cat>
    <def-cat n="il_det_sg">
       <cat-item lemma="il" tags="det.def.*.sg"/>
    </def-cat>
    <def-cat n="non">
       <cat-item lemma="non" tags="adv"/>
    </def-cat>
    <def-cat n="circa">
       <cat-item lemma="circa" tags="adv"/>
    </def-cat>
    <def-cat n="molto_proprio">
       <cat-item lemma="molto" tags="preadv"/>
       <cat-item lemma="proprio" tags="preadv"/>
       <cat-item lemma="granché" tags="preadv"/>
    </def-cat>
    <def-cat n="così">
       <cat-item lemma="così" tags="adv"/>
       <cat-item lemma="così" tags="preadv"/>
    </def-cat>
    <def-cat n="come-reladv">
       <cat-item lemma="come" tags="rel.adv"/>
       <cat-item lemma="come" tags="adv.itg"/>	<!-- per agafar anàlisis equivocades -->
       <cat-item lemma="come" tags="cnjadv"/>	<!-- per agafar anàlisis equivocades -->
    </def-cat>
    <def-cat n="come-pr">
       <cat-item lemma="come" tags="pr"/>
    </def-cat>
    <def-cat n="tanto">
       <cat-item lemma="tanto" tags="adv"/>
       <cat-item lemma="tanto" tags="preadv"/>
    </def-cat>
    <def-cat n="proprio_adv">
       <cat-item lemma="proprio" tags="adv"/>
    </def-cat>
    <def-cat n="cnjadv">
       <cat-item tags="cnjadv"/>
    </def-cat>
    <def-cat n="cnjcoo">
       <cat-item tags="cnjcoo"/>
    </def-cat>
    <def-cat n="cnjsub">
       <cat-item tags="cnjsub"/>
    </def-cat>
    <def-cat n="quanto-cnjadv">
       <cat-item lemma="quanto" tags="cnjadv"/>
    </def-cat>
    <def-cat n="più-meno">
       <cat-item lemma="più" tags="adv"/>
       <cat-item lemma="meno" tags="adv"/>
    </def-cat>
    <def-cat n="può_essere">
       <cat-item lemma="può essere" tags="adv"/>
    </def-cat>
    <def-cat n="quello">
       <cat-item lemma="quello" tags="det.*"/>
       <cat-item lemma="quello" tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="prnpers">
       <cat-item lemma="io" tags="prn.tn.*"/>
       <cat-item lemma="tu" tags="prn.tn.*"/>
       <cat-item lemma="lui" tags="prn.tn.*"/>
       <cat-item lemma="lei" tags="prn.tn.*"/> <!-- necessario per 'Lei' -->
       <cat-item lemma="Lei" tags="prn.tn.*"/>
       <cat-item lemma="noi" tags="prn.tn.*"/>
       <cat-item lemma="voi" tags="prn.tn.*"/>
       <cat-item lemma="loro" tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="che">
       <cat-item lemma="che" tags="cnjsub"/>
       <cat-item lemma="che" tags="rel.an.*"/>
    </def-cat>
    <def-cat n="di_nuovo">
       <cat-item lemma="di nuovo" tags="adv"/>
    </def-cat>
    <def-cat n="cm">
       <cat-item tags="cm"/>
    </def-cat>
    <def-cat n="sent">
       <cat-item tags="sent"/>
    </def-cat>
    <def-cat n="lingua_mf">
       <cat-item lemma="inglese" tags="n.*"/>
       <cat-item lemma="francese" tags="n.*"/>
       <cat-item lemma="cinese" tags="n.*"/>
       <cat-item lemma="giapponese" tags="n.*"/>
    </def-cat>
    <def-cat n="casa">
       <cat-item lemma="casa" tags="n.*"/>
    </def-cat>
    <def-cat n="milione">
       <cat-item lemma="milione" tags="n.*"/>
       <cat-item lemma="miliardo" tags="n.*"/>
       <cat-item lemma="bilione" tags="n.*"/>
    </def-cat>
    <def-cat n="mezzo">
       <cat-item lemma="mezzo" tags="n.*"/>
    </def-cat>
    <def-cat n="nom_famiglia_casa">	<!-- famiglia + casa -->
       <cat-item lemma="padre" tags="n.*"/>
       <cat-item lemma="papà" tags="n.*"/>
       <cat-item lemma="madre" tags="n.*"/>
       <cat-item lemma="mamma" tags="n.*"/>
       <cat-item lemma="babbo" tags="n.*"/>
       <cat-item lemma="genitore" tags="n.*"/>
       <cat-item lemma="figlio" tags="n.*"/>
       <cat-item lemma="figliolo" tags="n.*"/>
       <cat-item lemma="nonno" tags="n.*"/>
       <cat-item lemma="nonna" tags="n.*"/>
       <cat-item lemma="bisnonno" tags="n.*"/>
       <cat-item lemma="bisnonna" tags="n.*"/>
       <cat-item lemma="padrino" tags="n.*"/>
       <cat-item lemma="madrina" tags="n.*"/>
       <cat-item lemma="zio" tags="n.*"/>
       <cat-item lemma="nipote" tags="n.*"/>
       <cat-item lemma="pronipote" tags="n.*"/>
       <cat-item lemma="cugino" tags="n.*"/>
       <cat-item lemma="cugina" tags="n.*"/>
       <cat-item lemma="fratello" tags="n.*"/>
       <cat-item lemma="sorella" tags="n.*"/>
       <cat-item lemma="sorellina" tags="n.*"/>
       <cat-item lemma="patrigno" tags="n.*"/>
       <cat-item lemma="matrigna" tags="n.*"/>
       <cat-item lemma="fratellastro" tags="n.*"/>
       <cat-item lemma="sorellastra" tags="n.*"/>
       <cat-item lemma="marito" tags="n.*"/>
       <cat-item lemma="moglie" tags="n.*"/>

       <cat-item lemma="casa" tags="n.*"/>
    </def-cat>
    <def-cat n="mese_n">
       <cat-item lemma="gennaio" tags="n.*"/>
       <cat-item lemma="febbraio" tags="n.*"/>
       <cat-item lemma="marzo" tags="n.*"/>
       <cat-item lemma="aprile" tags="n.*"/>
       <cat-item lemma="maggio" tags="n.*"/>
       <cat-item lemma="giugno" tags="n.*"/>
       <cat-item lemma="luglio" tags="n.*"/>
       <cat-item lemma="agosto" tags="n.*"/>
       <cat-item lemma="settembre" tags="n.*"/>
       <cat-item lemma="ottobre" tags="n.*"/>
       <cat-item lemma="novembre" tags="n.*"/>
       <cat-item lemma="dicembre" tags="n.*"/>
    </def-cat>
    <def-cat n="inizio_fine">
       <cat-item lemma="inizio" tags="n.*"/>
       <cat-item lemma="metà" tags="n.*"/>
       <cat-item lemma="fine" tags="n.*"/>
    </def-cat>
    <def-cat n="migliore_peggiore">
       <cat-item lemma="migliore" tags="adj.*"/>
       <cat-item lemma="peggiore" tags="adj.*"/>
    </def-cat>
  </section-def-cats>

  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_np">
      <attr-item tags="ant"/>
      <attr-item tags="cog"/>
      <attr-item tags="top"/>
      <attr-item tags="al"/>
    </def-attr>
   <def-attr n="a_num">
     <attr-item tags="num"/>
  </def-attr>
  <def-attr n="gen">
     <attr-item tags="m"/>
     <attr-item tags="f"/>
     <attr-item tags="nt"/>
     <attr-item tags="mf"/>
     <attr-item tags="GD"/>
  </def-attr>
  <def-attr n="nbr">
     <attr-item tags="ND"/>
     <attr-item tags="sp"/>
     <attr-item tags="sg"/>
     <attr-item tags="pl"/>
  </def-attr>
  <def-attr n="pers">
     <attr-item tags="p1"/>
     <attr-item tags="p2"/>
     <attr-item tags="p3"/>
  </def-attr>

  <def-attr n="a_adj">
    <attr-item tags="adj.ind"/>
    <attr-item tags="adj.sup"/>
    <attr-item tags="adj.itg"/>
    <attr-item tags="adj.pos"/>
    <attr-item tags="adj"/>
  </def-attr>

  <def-attr n="a_adjec">
    <attr-item tags="adj.ind"/>
    <attr-item tags="adj.sup"/>
    <attr-item tags="adj.itg"/>
    <attr-item tags="adj.pos"/>
    <attr-item tags="adj"/>
    <attr-item tags="vblex.pp"/>
    <attr-item tags="vblex.tv.pp"/>
    <attr-item tags="vblex.pron.pp"/>
    <attr-item tags="vblex.nopron.pp"/>
    <attr-item tags="vblex.non-pron.pp"/>
    <attr-item tags="vbhaver.pp"/>
    <attr-item tags="vbser.pp"/>
    <attr-item tags="vbmod.pp"/>
  </def-attr>

  <def-attr n="a_adj_sup">
     <attr-item tags="adj.sup"/>
  </def-attr>
  <def-attr n="a_adj_ord">
     <attr-item tags="adj.ord"/>
  </def-attr>
  <def-attr n="a_adj_post">
     <attr-item tags="adj.post"/>
  </def-attr>
  <def-attr n="a_det">
     <attr-item tags="det.ind"/>
     <attr-item tags="det.dem"/>
     <attr-item tags="det.pos"/>
     <attr-item tags="predet"/>
     <attr-item tags="det.def"/>
  </def-attr>
  <def-attr n="a_prn">
     <attr-item tags="prn.pro"/>
     <attr-item tags="prn.enc"/>
  </def-attr>
  <def-attr n="tipus_prn">
    <attr-item tags="prn.tn.pos"/>
    <attr-item tags="prn.tn.ref"/>
    <attr-item tags="prn.tn"/>
    <attr-item tags="prn.itg"/>
    <attr-item tags="prn.pro"/>
    <attr-item tags="prn.pro.adv"/>
    <attr-item tags="prn.pro.ref"/>
    <attr-item tags="prn.enc"/>
    <attr-item tags="prn.enc.adv"/>
    <attr-item tags="prn.enc.ref"/>
    <attr-item tags="prn.dem"/>
    <attr-item tags="prn.ind"/>
    <attr-item tags="prn.pos"/>
    <attr-item tags="prn.enc"/>
  </def-attr>
  <def-attr n="a_verb">
     <attr-item tags="vblex"/>
     <attr-item tags="vbmod"/>
     <attr-item tags="vbser"/>
     <attr-item tags="vbhaver"/>
  </def-attr>
  <def-attr n="temps">
     <attr-item tags="pri"/>
     <attr-item tags="prs"/>
     <attr-item tags="pii"/>
     <attr-item tags="pis"/>
     <attr-item tags="ifi"/>
     <attr-item tags="imp"/>
     <attr-item tags="fti"/>
     <attr-item tags="cni"/>
     <attr-item tags="inf"/>
     <attr-item tags="pp"/>
     <attr-item tags="ger"/>
  </def-attr>
   <def-attr n="a_np_acr">
     <attr-item tags="np"/>
     <attr-item tags="acr"/>
   </def-attr>
</section-def-attrs>

<section-def-vars>
  <def-var n="genero" v="&lt;m&gt;"/>
  <def-var n="numero" v="&lt;sg&gt;"/>
  <def-var n="genero_sl" v="&lt;m&gt;"/>
  <def-var n="numero_sl" v="&lt;sg&gt;"/>
  <def-var n="genero_tl" v="&lt;m&gt;"/>
  <def-var n="numero_tl" v="&lt;sg&gt;"/>
  <def-var n="concPrimero"/>
  <def-var n="concSegundo"/>
  <def-var n="concTercero"/>
  <def-var n="concCuarto"/>
  <def-var n="caseFirstWord"/>
  <def-var n="chunkname"/>
  <def-var n="x"/>
  <def-var n="y"/>
  <def-var n="z"/>
  <def-var n="EOS"/>
  <def-var n="debug"/>
</section-def-vars>

<section-def-lists>
    <def-list n="numrom">
       <list-item v="I"/>
       <list-item v="II"/>
       <list-item v="III"/>
       <list-item v="IV"/>
       <list-item v="V"/>
       <list-item v="VI"/>
       <list-item v="VII"/>
       <list-item v="VIII"/>
       <list-item v="IX"/>
       <list-item v="X"/>
       <list-item v="XI"/>
       <list-item v="XII"/>
       <list-item v="XIII"/>
       <list-item v="XIV"/>
       <list-item v="XV"/>
       <list-item v="XVI"/>
       <list-item v="XVII"/>
       <list-item v="XVIII"/>
       <list-item v="XIX"/>
       <list-item v="XX"/>
       <list-item v="XXI"/>
       <list-item v="XXII"/>
       <list-item v="XXII"/>
       <list-item v="XXIII"/>
       <list-item v="XXIV"/>
       <list-item v="XXV"/>
       <list-item v="XXVI"/>
       <list-item v="XXVII"/>
       <list-item v="XXVIII"/>
       <list-item v="XXIX"/>
       <list-item v="XXX"/>
    </def-list>
    <def-list n="trencats">
      <list-item v="terzo"/>
      <list-item v="quarto"/>
      <list-item v="quinto"/>
      <list-item v="sesto"/>
      <list-item v="settimo"/>
      <list-item v="ottavo"/>
      <list-item v="nono"/>
    </def-list>
    <def-list n="mese">
       <list-item v="gennaio"/>
       <list-item v="febbraio"/>
       <list-item v="marzo"/>
       <list-item v="aprile"/>
       <list-item v="maggio"/>
       <list-item v="giugno"/>
       <list-item v="luglio"/>
       <list-item v="agosto"/>
       <list-item v="settembre"/>
       <list-item v="ottobre"/>
       <list-item v="novembre"/>
       <list-item v="dicembre"/>
    </def-list>
    <def-list n="adv_post">
      <list-item v="meda"/>
      <list-item v="a bassu"/>
      <list-item v="a bellu"/>
      <list-item v="a beru"/>
      <list-item v="a curtzu"/>
      <list-item v="a forte"/>
      <list-item v="a lestru"/>
      <list-item v="a longu"/>
      <list-item v="a malu"/>
      <list-item v="a primu"/>
      <list-item v="a tessu"/>
      <list-item v="a ùrtimu"/>
      <list-item v="a s'abertu"/>
      <list-item v="a sa dereta"/>
      <list-item v="a sa lestra"/>
      <list-item v="a sa grussera"/>
      <list-item v="a sa minuda"/>
      <list-item v="a sa longa"/>
      <list-item v="a sa prima"/>
      <list-item v="a sa revessa"/>
      <list-item v="a sa sola"/>
      <list-item v="a sas primas"/>
    </def-list>
    <def-list n="vbambser">
      <list-item v="andare"/>
      <list-item v="crèschere"/>
      <list-item v="frenare"/>
      <list-item v="divenire"/>
      <list-item v="devènnere"/>
      <list-item v="arribare"/>
      <list-item v="arribbare"/>
      <list-item v="intrare"/>
      <list-item v="nàschere"/>
      <list-item v="partire"/>
      <list-item v="restare"/>
      <list-item v="bènnere"/>
      <list-item v="essire"/>
      <list-item v="fugire"/>
      <list-item v="isfugire"/>
      <list-item v="colare"/>
      <list-item v="èssere"/>
      <list-item v="istare"/>
      <list-item v="pèndere"/>
      <list-item v="artziare"/>
      <list-item v="bàlere"/>
      <list-item v="sèere"/>
      <list-item v="pròere"/>
      <list-item v="variare"/>	<!-- només intr i pron... però això és la norma -->
      <list-item v="abbigiare"/>	<!-- perquè pron (crec) -->
<!--      <list-item v="torrare"/> cas especial -->
    </def-list>
</section-def-lists>

<section-def-macros>

    <def-macro n="f_chunk_tags_gen" npar="1">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_m"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="f"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_f"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="mf"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_mf"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags_nbr" npar="1">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sg"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_pl"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sp"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags" npar="1">
      <call-macro n="f_chunk_tags_gen"><with-param pos="1"/></call-macro>
      <call-macro n="f_chunk_tags_nbr"><with-param pos="1"/></call-macro>
    </def-macro>

    <def-macro n="f_clean_post" npar="1" c="clean 'post' in 'adj.post' if it exists">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="tl" part="a_adj_post"/><lit-tag v="adj.post"/></equal>
          </test>
          <let><clip pos="1" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_reord_adj" npar="2" c="par1=n, par2=adj: interchange par1 and par2">
<!-- WARNING: BUG! It's not working with "su propria retrocessione", where propria=adj.post and retrocessione>torrada a dae segus. par2.lemq is not created -->
<!-- I don't reorder if tl has lemq -->
      <let><var n="genero_tl"/><clip pos="1" side="tl" part="gen"/></let>	<!-- we need to get the gen & nbr of the noun because it may change its position -->
      <let><var n="numero_tl"/><clip pos="1" side="tl" part="nbr"/></let>
      <choose>
        <when>
          <test>
            <and>
            <equal><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj.post"/></equal>
            <equal><clip pos="1" side="tl" part="lemq"/><lit v=""/></equal>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><var n="x"/><get-case-from pos="1"><clip pos="1" side="sl" part="lemh"/></get-case-from></let>
          <let><var n="y"/><clip pos="1" side="sl" part="tags"/></let>
          <let><var n="z"/><clip pos="1" side="sl" part="lemq"/></let>
          <let><clip pos="1" side="sl" part="lemh"/><get-case-from pos="2"><clip pos="2" side="sl" part="lemh"/></get-case-from></let>
          <let><clip pos="1" side="sl" part="tags"/><clip pos="2" side="sl" part="tags"/></let>
          <let><clip pos="1" side="sl" part="lemq"/><clip pos="2" side="sl" part="lemq"/></let>
          <let><clip pos="2" side="sl" part="lemh"/><var n="x"/></let>
          <let><clip pos="2" side="sl" part="tags"/><var n="y"/></let>
          <let><clip pos="2" side="sl" part="lemq"/><var n="z"/></let>

          <choose>
            <when>
              <test>
                <equal><case-of pos="1" side="sl" part="lemh"/><lit v="Aa"/></equal>
              </test>
              <let><var n="x"/><get-case-from pos="1"><clip pos="1" side="tl" part="lemh"/></get-case-from></let>
              <let><var n="y"/><clip pos="1" side="tl" part="tags"/></let>
              <let><var n="z"/><clip pos="1" side="tl" part="lemq"/></let>
              <let><clip pos="1" side="tl" part="lemh"/><get-case-from pos="2"><clip pos="2" side="tl" part="lemh"/></get-case-from></let>
              <let><clip pos="1" side="tl" part="tags"/><clip pos="2" side="tl" part="tags"/></let>
              <let><clip pos="1" side="tl" part="lemq"/><clip pos="2" side="tl" part="lemq"/></let>
              <let><clip pos="2" side="tl" part="lemh"/><var n="x"/></let>
              <let><clip pos="2" side="tl" part="tags"/><var n="y"/></let>
              <let><clip pos="2" side="tl" part="lemq"/><var n="z"/></let>
            </when>
            <otherwise>
              <let><var n="x"/><clip pos="1" side="tl" part="lemh"/></let>
              <let><var n="y"/><clip pos="1" side="tl" part="tags"/></let>
              <let><var n="z"/><clip pos="1" side="tl" part="lemq"/></let>
              <let><clip pos="1" side="tl" part="lemh"/><clip pos="2" side="tl" part="lemh"/></let>
              <let><clip pos="1" side="tl" part="tags"/><clip pos="2" side="tl" part="tags"/></let>
              <let><clip pos="1" side="tl" part="lemq"/><clip pos="2" side="tl" part="lemq"/></let>
              <let><clip pos="2" side="tl" part="lemh"/><var n="x"/></let>
              <let><clip pos="2" side="tl" part="tags"/><var n="y"/></let>
              <let><clip pos="2" side="tl" part="lemq"/><var n="z"/></let>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_reord_adj3" npar="3" c="par1=n, par2=adj par3=adj: put par3 at the end if it is adj.post">
<!-- WARNING: BUG! It's not working with "su propria retrocessione", where propria=adj.post and retrocessione>torrada a dae segus. par2.lemq is not created -->
<!-- I don't reorder if tl has lemq -->
      <let><var n="genero_tl"/><clip pos="1" side="tl" part="gen"/></let>	<!-- we need to get the gen & nbr of the noun because it may change its position -->
      <let><var n="numero_tl"/><clip pos="1" side="tl" part="nbr"/></let>
      <choose>
        <when>
          <test>
            <and>
            <equal><clip pos="3" side="tl" part="a_adj_post"/><lit-tag v="adj.post"/></equal>
            <equal><clip pos="1" side="tl" part="lemq"/><lit v=""/></equal>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="3" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><var n="x"/><clip pos="1" side="sl" part="lemh"/></let>
          <let><var n="y"/><clip pos="1" side="sl" part="tags"/></let>
          <let><var n="z"/><clip pos="1" side="sl" part="lemq"/></let>
          <let><clip pos="1" side="sl" part="lemh"/><clip pos="2" side="sl" part="lemh"/></let>
          <let><clip pos="1" side="sl" part="tags"/><clip pos="2" side="sl" part="tags"/></let>
          <let><clip pos="1" side="sl" part="lemq"/><clip pos="2" side="sl" part="lemq"/></let>
          <let><clip pos="2" side="sl" part="lemh"/><clip pos="3" side="sl" part="lemh"/></let>
          <let><clip pos="2" side="sl" part="tags"/><clip pos="3" side="sl" part="tags"/></let>
          <let><clip pos="2" side="sl" part="lemq"/><clip pos="3" side="sl" part="lemq"/></let>
          <let><clip pos="3" side="sl" part="lemh"/><var n="x"/></let>
          <let><clip pos="3" side="sl" part="tags"/><var n="y"/></let>
          <let><clip pos="3" side="sl" part="lemq"/><var n="z"/></let>

          <let><var n="x"/><clip pos="1" side="tl" part="lemh"/></let>
          <let><var n="y"/><clip pos="1" side="tl" part="tags"/></let>
          <let><var n="z"/><clip pos="1" side="tl" part="lemq"/></let>
          <let><clip pos="1" side="tl" part="lemh"/><clip pos="2" side="tl" part="lemh"/></let>
          <let><clip pos="1" side="tl" part="tags"/><clip pos="2" side="tl" part="tags"/></let>
          <let><clip pos="1" side="tl" part="lemq"/><clip pos="2" side="tl" part="lemq"/></let>
          <let><clip pos="2" side="tl" part="lemh"/><clip pos="3" side="tl" part="lemh"/></let>
          <let><clip pos="2" side="tl" part="tags"/><clip pos="3" side="tl" part="tags"/></let>
          <let><clip pos="2" side="tl" part="lemq"/><clip pos="3" side="tl" part="lemq"/></let>
          <let><clip pos="3" side="tl" part="lemh"/><var n="x"/></let>
          <let><clip pos="3" side="tl" part="tags"/><var n="y"/></let>
          <let><clip pos="3" side="tl" part="lemq"/><var n="z"/></let>
        </when>
        <otherwise>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="3" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_reord_adj4" npar="4" c="par1=n, par2=adj par3=adj par4=adj: put par4 at the end if it is adj.post">
<!-- WARNING: BUG! It's not working with "su propria retrocessione", where propria=adj.post and retrocessione>torrada a dae segus. par2.lemq is not created -->
<!-- I don't reorder if tl has lemq -->
      <let><var n="genero_tl"/><clip pos="1" side="tl" part="gen"/></let>	<!-- we need to get the gen & nbr of the noun because it may change its position -->
      <let><var n="numero_tl"/><clip pos="1" side="tl" part="nbr"/></let>
      <choose>
        <when>
          <test>
            <and>
            <equal><clip pos="4" side="tl" part="a_adj_post"/><lit-tag v="adj.post"/></equal>
            <equal><clip pos="1" side="tl" part="lemq"/><lit v=""/></equal>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="3" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="4" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><var n="x"/><clip pos="1" side="sl" part="lemh"/></let>
          <let><var n="y"/><clip pos="1" side="sl" part="tags"/></let>
          <let><var n="z"/><clip pos="1" side="sl" part="lemq"/></let>
          <let><clip pos="1" side="sl" part="lemh"/><clip pos="2" side="sl" part="lemh"/></let>
          <let><clip pos="1" side="sl" part="tags"/><clip pos="2" side="sl" part="tags"/></let>
          <let><clip pos="1" side="sl" part="lemq"/><clip pos="2" side="sl" part="lemq"/></let>
          <let><clip pos="2" side="sl" part="lemh"/><clip pos="3" side="sl" part="lemh"/></let>
          <let><clip pos="2" side="sl" part="tags"/><clip pos="3" side="sl" part="tags"/></let>
          <let><clip pos="2" side="sl" part="lemq"/><clip pos="3" side="sl" part="lemq"/></let>
          <let><clip pos="3" side="sl" part="lemh"/><clip pos="4" side="sl" part="lemh"/></let>
          <let><clip pos="3" side="sl" part="tags"/><clip pos="4" side="sl" part="tags"/></let>
          <let><clip pos="3" side="sl" part="lemq"/><clip pos="4" side="sl" part="lemq"/></let>
          <let><clip pos="4" side="sl" part="lemh"/><var n="x"/></let>
          <let><clip pos="4" side="sl" part="tags"/><var n="y"/></let>
          <let><clip pos="4" side="sl" part="lemq"/><var n="z"/></let>

          <let><var n="x"/><clip pos="1" side="tl" part="lemh"/></let>
          <let><var n="y"/><clip pos="1" side="tl" part="tags"/></let>
          <let><var n="z"/><clip pos="1" side="tl" part="lemq"/></let>
          <let><clip pos="1" side="tl" part="lemh"/><clip pos="2" side="tl" part="lemh"/></let>
          <let><clip pos="1" side="tl" part="tags"/><clip pos="2" side="tl" part="tags"/></let>
          <let><clip pos="1" side="tl" part="lemq"/><clip pos="2" side="tl" part="lemq"/></let>
          <let><clip pos="2" side="tl" part="lemh"/><clip pos="3" side="tl" part="lemh"/></let>
          <let><clip pos="2" side="tl" part="tags"/><clip pos="3" side="tl" part="tags"/></let>
          <let><clip pos="2" side="tl" part="lemq"/><clip pos="3" side="tl" part="lemq"/></let>
          <let><clip pos="3" side="tl" part="lemh"/><clip pos="4" side="tl" part="lemh"/></let>
          <let><clip pos="3" side="tl" part="tags"/><clip pos="4" side="tl" part="tags"/></let>
          <let><clip pos="3" side="tl" part="lemq"/><clip pos="4" side="tl" part="lemq"/></let>
          <let><clip pos="4" side="tl" part="lemh"/><var n="x"/></let>
          <let><clip pos="4" side="tl" part="tags"/><var n="y"/></let>
          <let><clip pos="4" side="tl" part="lemq"/><var n="z"/></let>
        </when>
        <otherwise>
          <let><clip pos="2" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="3" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
          <let><clip pos="4" side="tl" part="a_adj_post"/><lit-tag v="adj"/></let>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_concord1" npar="1">

      <choose><!--To determine value of variables of gender and
		  number and propagate to other rules.  Variables are
		  not used again in this rule -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let><var n="genero"/><lit-tag v="m"/></let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let><var n="genero"/><lit-tag v="f"/></let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let><var n="numero"/><lit-tag v="sg"/></let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let><var n="numero"/><lit-tag v="pl"/></let>
	</when>
      </choose>
      <choose>
	<when>
	  <test> <!-- If word has GD or ND, we try to assign the
		      gender or number of the previous rule. If there is no
		      value for the gender or number variable from previous
		      rules, gender will be masculine and number singular.-->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <choose>

	    <when>	<!-- Specific for ITA-SRD: for numerals, a better guess is "m", e.g. "fine (de) (s') Ottocento" -->
	      <test>
		<and>
		  <equal><clip pos="1" side="tl" part="a_num"/><lit-tag v="num"/></equal>
		  <or>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="dughentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="treghentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="batorghentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="chimbighentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="sesghentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="setighentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="otighentos"/></equal>
		    <equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="noighentos"/></equal>
		  </or>
		</and>
	      </test>
	      <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
	      <let><var n="genero"/><lit-tag v="m"/></let>
	      <let><var n="numero"/><lit-tag v="pl"/></let>
	    </when>

	    <when>
	      <test>
		<equal>
		  <var n="genero"/>
		  <lit-tag v="f"/>
		</equal>
	      </test>
	      <let><clip pos="1" side="tl" part="gen"/><lit-tag v="f"/></let>
	    </when>
	    <otherwise>
	      <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <var n="numero"/>
		  <lit-tag v="pl"/>
		</equal>
	      </test>
	      <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
	    </when>
	    <otherwise>
	      <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
    </def-macro>


    <def-macro n="f_concord2" npar="2">

      <!-- pedaç per a coses com "200.000 unità" i "tre unità" -->
      <!--
        ^200.000<num>/200.000<num>$ ^unità<n><f><sp>/unitat<n><f><ND>$
        ^tre<num><mf><sp>/tres<num><mf><sp>$ ^unità<n><f><sp>/unitat<n><f><ND>$^
      -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
              <equal><clip pos="2" side="tl" part="a_num"/><lit-tag v="num"/></equal>
	      <or>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                <equal><clip pos="2" side="tl" part="nbr"/><lit v=""/></equal>
              </or>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
          <let><var n="numero"/><lit-tag v="pl"/></let>
        </when>
      </choose>

      <choose>
	<when>
	  <test> <!-- do the main and second parameter gender agree?-->
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal> <!-- do the main and second parameter number agree?-->
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let><!-- there is gender and number agreement-->
	</when>
	<otherwise>
	  <let><var n="concPrimero"/><lit v="false"/></let><!-- there isn't gender and number agreement-->
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test> <!-- Propagate the main parameter gender if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test> <!-- Propagate the main parameter number if it has been modified during the translation  -->
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test> <!-- Which is the rule general gender? -->
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>



      <choose>
	<when><!-- Which is the rule general number? -->
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="a_num"/>
		<lit-tag v="num"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose> <!-- Determine gender and number value if they are undetermined -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>


    <def-macro n="f_concord3" npar="3">

      <!-- pedaç per a coses com "200.000 unità" i "tre unità" -->
      <!--
        ^200.000<num>/200.000<num>$ ^unità<n><f><sp>/unitat<n><f><ND>$
        ^tre<num><mf><sp>/tres<num><mf><sp>$ ^unità<n><f><sp>/unitat<n><f><ND>$^
      -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
              <equal><clip pos="2" side="tl" part="a_num"/><lit-tag v="num"/></equal>
	      <or>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                <equal><clip pos="2" side="tl" part="nbr"/><lit v=""/></equal>
              </or>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
          <let><var n="numero"/><lit-tag v="pl"/></let>
        </when>
      </choose>

      <choose><!-- Look whether in source language there is concordance between first and second element -->
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concPrimero"/><lit v="false"/></let>
	</otherwise>
      </choose>
      <choose><!-- Look whether in source language there is concordance between second and third element -->
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concSegundo"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concSegundo"/><lit v="false"/></let>
	</otherwise>
      </choose>


      <choose><!-- Propagate the main parameter gender if it has been modified during the translation -->
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose><!-- Propagate the main parameter number if it has been modified during the translation -->
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>



      <choose> <!-- Determine the rule general gender. Priority order: main, second and third element -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="2" side="sl" part="gen"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="genero"/>
	    <clip pos="3" side="sl" part="gen"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>

      <choose><!-- Determine the rule general number. Priority order: main, second and third element -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="1" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="2" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <not>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <clip pos="3" side="sl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="sp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	      <equal>
		<clip pos="2" side="tl" part="a_num"/>
		<lit-tag v="num"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose> <!-- Assign values to GD and ND -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>


    <def-macro n="f_concord4" npar="4">
      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concPrimero"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concSegundo"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concSegundo"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concTercero"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concTercero"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_concord5" npar="5">
      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concPrimero"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concPrimero"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concSegundo"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concSegundo"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concTercero"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concTercero"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <or>
		<equal>
		  <clip pos="5" side="sl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </or>
	      <or>
		<equal>
		  <clip pos="5" side="sl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </or>
	    </and>
	  </test>
	  <let><var n="concCuarto"/><lit v="true"/></let>
	</when>
	<otherwise>
	  <let><var n="concCuarto"/><lit v="false"/></let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="sl" part="gen"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="5" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="5" side="sl" part="gen"/>
			<lit-tag v="mf"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="5" side="tl" part="gen"/>
			  <lit-tag v="GD"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concCuarto"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="5" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test>
	    <and>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="sl" part="nbr"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </not>
	      <not>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="2" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concPrimero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concSegundo"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="4" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concTercero"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="4" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	  <choose>
	    <when>
	      <test>
		<and>
		  <not>
		    <equal>
		      <clip pos="5" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		  <not>
		    <and>
		      <equal>
			<clip pos="5" side="sl" part="nbr"/>
			<lit-tag v="sp"/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="5" side="tl" part="nbr"/>
			  <lit-tag v="ND"/>
			</equal>
		      </not>
		    </and>
		  </not>
		  <equal>
		    <var n="concCuarto"/>
		    <lit v="true"/>
		  </equal>
		</and>
	      </test>
	      <let>
		<clip pos="5" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="f"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="genero"/>
	    <lit-tag v="m"/>
	  </let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="numero"/>
	    <lit-tag v="sg"/>
	  </let>
	</otherwise>
      </choose>

      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="5" side="tl" part="gen"/>
	    <var n="genero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="3" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="4" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="5" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="5" side="tl" part="nbr"/>
	    <var n="numero"/>
	  </let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_concord_esp" npar="2"> <!-- if the noun has changed the gender and/or number articles and adjectives should too -->
	<!-- the first paramenter is the name, the second the article or adjective -->

      <!-- gender -->
      <choose>
	<when>
	  <test>
	    <and>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	    <equal>
	      <clip pos="1" side="sl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <clip pos="1" side="tl" part="gen"/>
	  </let>
	  <!-- we propagate the gender for f_concord2, f_concord3, etc. -->
<!-- doesn't give positive results
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="tl" part="gen"/>
	  </let>
-->
	</when>
	<when>
	  <test>
	    <and>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	    <equal>
	      <clip pos="1" side="sl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	    <equal>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <clip pos="1" side="tl" part="gen"/>
	  </let>
	  <!-- we propagate the gender for f_concord2, f_concord3, etc. -->
<!-- doesn't give positive results
	  <let>
	    <var n="genero"/>
	    <clip pos="1" side="tl" part="gen"/>
	  </let>
-->
	</when>
      </choose>

      <!-- number -->
      <choose>
	<when>
	  <test>
	    <and>
	    <equal>
	      <clip pos="1" side="tl" part="a_adj_ord"/>
	      <lit-tag v="adj.ord"/>
	    </equal>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sp"/>
	    </equal>
	    <equal>
	      <clip pos="2" side="sl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	    <equal>
	      <clip pos="1" side="sl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	    <equal>
	      <clip pos="1" side="sl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	    <equal>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</when>
      </choose>

    </def-macro>

    <def-macro n="f_concord_carchi2" npar="2"> <!-- if the first member is "charchi" the second one must be in singular (if it is pl) -->
      <choose>
	<when>
	  <test>
	    <and>
	    <equal><clip pos="1" side="tl" part="lem"/><lit v="carchi"/></equal>
	    <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
	    </and>
	  </test>
	  <let><clip pos="2" side="tl" part="nbr"/> <lit-tag v="sg"/></let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_concord_carchi3" npar="3"> <!-- if the first member is "charchi" the others must be in singular (if they are pl) -->
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="3"/>
      </call-macro>
    </def-macro>

    <def-macro n="f_concord_carchi4" npar="4"> <!-- if the first member is "charchi" the others must be in singular (if they are pl) -->
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="3"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="4"/>
      </call-macro>
    </def-macro>

    <def-macro n="f_concord_carchi5" npar="5"> <!-- if the first member is "charchi" the others must be in singular (if they are pl) -->
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="2"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="3"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="4"/>
      </call-macro>
      <call-macro n="f_concord_carchi2">
        <with-param pos="1"/>
        <with-param pos="5"/>
      </call-macro>
    </def-macro>

    <def-macro n="f_pr_tn-pers" npar="2">
      <choose>	<!-- To change to personal pronoun depending on the preposition -->
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="me"/></equal>
	  </test>
          <choose>
	    <when>
	      <test>
	        <or>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="bighinu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cantu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cara a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="che a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="chirru a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="comente a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="conca a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="contra a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun bista a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cunforma a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="dae segus a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="deretu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="finas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="fintzas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="gràtzias a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="in palas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="in tundu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="inferiore a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="riferidu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="rispetu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="superiore a"/></equal>
	        </or>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="mie"/></get-case-from></let>
	    </when>
	    <when>
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="megus"/></get-case-from></let>
	    </when>
	    <otherwise>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="mene"/></get-case-from></let>
	    </otherwise>
          </choose>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="te"/></equal>
	  </test>
          <choose>
	    <when>
	      <test>
	        <or>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="bighinu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cantu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cara a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="che a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="chirru a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="comente a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="conca a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="contra a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun bista a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cunforma a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="dae segus a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="deretu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="finas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="fintzas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="gràtzias a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="in palas a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="in tundu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="inferiore a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="riferidu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="rispetu a"/></equal>
	          <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="superiore a"/></equal>
	        </or>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tie"/></get-case-from></let>
	    </when>
	    <when>
	      <test>
	        <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="cun"/></equal>
	      </test>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tegus"/></get-case-from></let>
	    </when>
	    <otherwise>
	      <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="tene"/></get-case-from></let>
	    </otherwise>
          </choose>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="lui"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="issu"/></get-case-from></let>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="noi"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="nois"/></get-case-from></let>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="voi"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="bois"/></get-case-from></let>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="loro"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="issu"/></get-case-from></let>
	</when>
	<when>
	  <test>
	    <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="gli"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="lemh"/><get-case-from pos="2"><lit v="issu"/></get-case-from></let>
	  <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.tn"/></let>
	  <let><clip pos="2" side="tl" part="gen"/><var n="genero"/></let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="modif_case" npar="1">
      <choose>	<!-- To correct capital letters in such words as È (essere), I (article), etc -->
<!-- malauradament Aa no funciona en aquestes dues paraules (algun bug) -->
<!-- ^ESSERE<vbser><pri><p3><sg>$ ^IL<det><def><m><pl>$  -->
	<when>
	  <test>
	    <and>
	      <equal><clip pos="1" side="sl" part="lemh"/><lit v="ESSERE"/></equal>
	      <equal><clip pos="1" side="sl" part="temps"/><lit-tag v="pri"/></equal>
	      <equal><clip pos="1" side="sl" part="pers"/><lit-tag v="p3"/></equal>
	      <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
	    </and>
	  </test>
           <modify-case>
             <clip pos="1" side="tl" part="lemh"/>
             <lit v="Aa"/>
           </modify-case>
	</when>
	<when>
	  <test>
	    <and>
	      <equal><clip pos="1" side="sl" part="lemh"/><lit v="IL"/></equal>
	      <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
	      <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
	    </and>
	  </test>
           <modify-case>
             <clip pos="1" side="tl" part="lemh"/>
             <lit v="Aa"/>
           </modify-case>
	</when>
      </choose>
    </def-macro>

    <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>

  </section-def-macros>

<section-rules>

<rule comment="regla: det np">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="np"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_chunk_tags">
      <with-param pos="2"/>
    </call-macro>
    <out>
      <chunk name="det-np">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="whole"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>


<rule comment="regla: det nom: la casa > sa domo, el terç > su tres unu, un terç > su tres unu">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_concord_esp">
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_concord_carchi2">
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <call-macro n="f_chunk_tags">
      <with-param pos="2"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <choose>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="un"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="lemh"/><lit v="su"/></let>
            <let><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></let>
          </when>
        </choose>
        <out>
          <chunk name="det-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="unu_num"/>	<!-- to avoid un' -->
              <lit-tag v="num"/>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="sp"/>
            </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="det-nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>


<rule comment="regla: num nom: XVI secolo > sèculu XVI, XVI biennale, sa de XVI biennales, tre quarti > su de bator tre">
   <pattern>
     <pattern-item n="num"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord2">
       <with-param pos="2"/>
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_concord_esp">
       <with-param pos="2"/>
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_chunk_tags">
       <with-param pos="2"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <and>
             <in><clip pos="1" side="sl" part="lemh"/><list n="numrom"/></in>
	         <equal caseless="yes"><clip pos="2" side="sl" part="lem"/><lit v="secolo"/></equal>
           </and>
         </test>
         <out>
           <chunk name="n_adjord">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <when>
         <test>
           <in><clip pos="1" side="sl" part="lemh"/><list n="numrom"/></in>
         </test>
         <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></let>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <lit v="su"/>
               <lit-tag v="det.def"/>
               <var n="genero"/>
               <var n="numero"/>
             </lu>
             <b/>
             <lu>
               <lit v="de"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <when>
         <test>
           <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="trencats"/></in>
         </test>
         <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
         <out>
           <chunk name="det-nom-num">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="su"/>
               </get-case-from>
               <lit-tag v="det.def"/>
               <var n="genero"/>
               <var n="numero"/>
             </lu>
             <b/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="num_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: . num nom: . XVI secolo > . Sèculu XVI, . XVI biennale, . Sa de XVI biennales, . Tre quarti > . Su de bator tre">
   <pattern>
     <pattern-item n="sent"/>
     <pattern-item n="num"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <let><var n="genero"/><lit-tag v="m"/></let>
     <let><var n="numero"/><lit-tag v="sg"/></let>
     <call-macro n="f_concord2">
       <with-param pos="3"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_concord_esp">
       <with-param pos="3"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_chunk_tags">
       <with-param pos="3"/>
     </call-macro>
     <out>
       <chunk name="sent">
         <tags>
           <tag><lit-tag v="sent"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="whole"/>
         </lu>
       </chunk>
       <b pos="1"/>
     </out>
     <choose>
       <when>
         <test>
           <and>
             <in><clip pos="2" side="sl" part="lemh"/><list n="numrom"/></in>
	     <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="secolo"/></equal>
           </and>
         </test>
          <modify-case>
            <clip pos="3" side="tl" part="lemh"/>
            <lit v="Aa"/>
          </modify-case>
         <out>
           <chunk name="n_adjord">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <when>
         <test>
           <in><clip pos="2" side="sl" part="lemh"/><list n="numrom"/></in>
         </test>
         <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <lit v="Su"/>
               <lit-tag v="det.def"/>
               <clip pos="3" side="tl" part="gen"/>
               <lit-tag v="sg"/>
             </lu>
             <b/>
             <lu>
               <lit v="de"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <when>
         <test>
           <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
         </test>
         <modify-case><clip pos="2" side="tl" part="lem"/><lit v="aa"/></modify-case>
         <out>
           <chunk name="det-nom-num">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <get-case-from pos="2">
                 <lit v="su"/>
               </get-case-from>
               <lit-tag v="det.def"/>
               <var n="genero"/>
               <var n="numero"/>
             </lu>
             <b/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="num_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


    <rule comment="regla: num milione e mezzo di (5 milioni e mezzo di euro > 5 milliones e mèdiu de èuros: per evitare '5 milliones e mèdiu de èuro'">
       <pattern>
         <pattern-item n="num"/>
         <pattern-item n="milione"/>
         <pattern-item n="cnjcoo"/>
         <pattern-item n="mezzo"/>
         <pattern-item n="di"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="num_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
           </chunk>
           <b pos="4"/>
           <chunk name="pr">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: in lingua_mf (in inglese > in inglesu: per evitare 'in inglesa'">
       <pattern>
         <pattern-item n="in"/>
         <pattern-item n="lingua_mf"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
         <out>
           <chunk name="pr">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: a_da det_mf lingua_mf (dall'inglese > dae s'inglesu: per evitare 'dae sa inglesa'">
       <pattern>
         <pattern-item n="a_da"/>
         <pattern-item n="detdefmf"/>
         <pattern-item n="lingua_mf"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
         <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
         <out>
           <chunk name="pr">
             <tags>
               <tag><lit-tag v="PREP"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="det_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: inizio_fine mese_n (inizio gennaio = comintzu de ghennàriu)">
       <pattern>
         <pattern-item n="inizio_fine"/>
         <pattern-item n="mese_n"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <lit v="de"/><lit-tag v="pr"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: pr inizio_fine mese_n (fra inizio gennaio = intre su comintzu de ghennàriu)">
       <pattern>
         <pattern-item n="pr"/>
         <pattern-item n="inizio_fine"/>
         <pattern-item n="mese_n"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pr_n">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="whole"/>
           </lu>
           <b pos="1"/>
           <lu>
             <lit v="su"/><lit-tag v="det.def"/>
             <var n="genero"/>
             <var n="numero"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <lit v="de"/><lit-tag v="pr"/>
           </lu>
           <b/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjec nom">
       <pattern>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_reord_adj">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="adj_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><var n="genero_tl"/></tag>
               <tag><var n="numero_tl"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: detdef adjpos casa > domo adjpos">
       <pattern>
         <pattern-item n="detdef"/>
         <pattern-item n="adjpos"/>
         <pattern-item n="casa"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="det_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
         </chunk>
         </out>
         <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
       </action>
    </rule>


    <rule comment="regla: detdef adjpos casa adj > domo adj adjpos">
       <pattern>
         <pattern-item n="detdef"/>
         <pattern-item n="adjpos"/>
         <pattern-item n="casa"/>
         <pattern-item n="adj"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="det_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="2" side="tl" part="lem"/>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
         </chunk>
         </out>
         <call-macro n="f_bcond"><with-param pos="3"/><with-param pos="4"/></call-macro>
       </action>
    </rule>


    <rule comment="regla: adjpos nom_famiglia > detdef nom_famiglia">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="nom_famiglia_casa"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <or>
	         <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="suo"/></equal>
	         <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="loro"/></equal>
               </or>
             </test>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
                 </test>
	         <let><clip pos="1" side="tl" part="gen"/><clip pos="2" side="tl" part="gen"/></let>
               </when>
             </choose>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                 </test>
	         <let><clip pos="1" side="tl" part="nbr"/><clip pos="2" side="tl" part="nbr"/></let>
               </when>
             </choose>
             <out>
               <chunk name="det_n">
                 <tags>
                   <tag><lit-tag v="SN"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <lit v="su"/>
                   </get-case-from>
                   <lit-tag v="det"/><lit-tag v="def"/>
                   <var n="genero"/>
                   <var n="numero"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </when>
           <otherwise>
             <out>
               <chunk name="n_pos">
                 <tags>
                   <tag><lit-tag v="SN"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <clip pos="2" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <get-case-from pos="2">
                     <clip pos="1" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </otherwise>
         </choose>
       </action>
    </rule>

    <rule comment="regla: det loro nom_famiglia > detdef nom_famiglia">
       <pattern>
         <pattern-item n="detdef"/>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="nom_famiglia_casa"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="mf"/></equal>
             </test>
             <let><clip pos="1" side="tl" part="gen"/><clip pos="3" side="tl" part="gen"/></let>
           </when>
         </choose>
         <choose>
           <when>
             <test>
               <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
             </test>
             <let><clip pos="1" side="tl" part="nbr"/><clip pos="3" side="tl" part="nbr"/></let>
           </when>
         </choose>
         <out>
           <chunk name="det_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lem"/>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
         <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
       </action>
    </rule>


    <rule comment="regla: adjpos nom > nom adjpos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: loro.pos nom > nom adjpos">
       <pattern>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="issoro"/>
             </get-case-from>
             <lit-tag v="adj"/><lit-tag v="pos"/><lit-tag v="mf"/><lit-tag v="sp"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos nom adj > nom adj adjpos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="n_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjpos nom adj > det nom adj adjpos: il nostro Sistema Solare > su Sistema Solare Nostru">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjpos"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="det_n_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjpos adj nom > det adj nom adjpos (i suoi ultimi giorni > sas ùrtimas dies suas ; il suo nuovo gioco > su giogu nou suo">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjpos"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_reord_adj">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="det_adj_n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: loro.pos nom adj > nom adj adjpos">
       <pattern>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="n_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="issoro"/>
             </get-case-from>
             <lit-tag v="adj"/><lit-tag v="pos"/><lit-tag v="mf"/><lit-tag v="sp"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos adj nom > adj nom adjpos: la sua apparente indifferenza > sa aparente indiferèntzia sua">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adj_n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: loro.pos adj nom > adj nom adjpos (il loro ultimo lavoro > s'ùrtimu traballu issoro)">
       <pattern>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="n_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="issoro"/>
             </get-case-from>
             <lit-tag v="adj"/><lit-tag v="pos"/><lit-tag v="mf"/><lit-tag v="sp"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos nom adj adj > nom adj adj adjpos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="n_adj_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: loro.pos nom adj adj > nom adj adj adjpos">
       <pattern>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="n_adj_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="issoro"/>
             </get-case-from>
             <lit-tag v="adj"/><lit-tag v="pos"/><lit-tag v="mf"/><lit-tag v="sp"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: loro.pos adj nom adj > adj nom adj adjpos (loro proclamate volontà rivoluzionarie > sas proclamadas voluntades rivolutzionàrias issoro">
       <pattern>
         <pattern-item n="loro_pos"/> <!-- aceptamos prn.tn.pos para solucionar problemas de mal analisis morfologico -->
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="adj_n_adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="issoro"/>
             </get-case-from>
             <lit-tag v="adj"/><lit-tag v="pos"/><lit-tag v="mf"/><lit-tag v="sp"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjord: terza > de tres, Terza > Su de tres">
       <pattern>
         <pattern-item n="adjord"/>
       </pattern>
       <action>
     <call-macro n="f_concord1">
       <with-param pos="1"/>
     </call-macro>
     <choose>
       <when>
         <test>
	    <and>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="primu"/></equal></not>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="segundu"/></equal></not>
           <equal>
             <case-of pos="1" side="sl" part="lemh"/>
             <lit v="Aa"/>
           </equal>
	    </and>
           </test>
           <!-- considerem que és inici de frase (comença amb majúscula i no hi ha article: no es "la Tercera República" -->
           <!-- afegim l'article -->
           <modify-case>
             <clip pos="1" side="tl" part="lemh"/>
             <lit v="aa"/>
           </modify-case>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
               <lit v="Su"/><lit-tag v="det"/><lit-tag v="def"/>
               <lit-tag v="m"/>
               <lit-tag v="sg"/>
           </lu>
           <b/>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="adjord">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </otherwise>
     </choose>
       </action>
    </rule>


    <rule comment="regla: adjord nom: terza casa > de tres domos, Terza casa > Sa de tres domos">
       <pattern>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
     <choose>
       <when>
         <test>
           <and>
             <equal><clip pos="1" side="tl" part="lem"/><lit v="1º"/></equal>
             <in caseless="yes"><clip pos="2" side="sl" part="lemh"/><list n="mese"/></in>
           </and>
         </test>
         <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
         <out>
           <chunk name="adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </when>
       <when>
         <test>
	    <and>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="primu"/></equal></not>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="segundu"/></equal></not>
           <equal>
             <case-of pos="1" side="sl" part="lemh"/>
             <lit v="Aa"/>
           </equal>
	    </and>
           </test>
           <!-- considerem que és inici de frase (comença amb majúscula i no hi ha article: no es "la Tercera República" -->
           <!-- afegim l'article -->
           <modify-case>
             <clip pos="1" side="tl" part="lemh"/>
             <lit v="aa"/>
           </modify-case>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
               <lit v="Su"/><lit-tag v="det"/><lit-tag v="def"/>
               <clip pos="2" side="tl" part="gen"/>
               <lit-tag v="sg"/>
           </lu>
           <b/>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </otherwise>
     </choose>
       </action>
    </rule>


    <rule comment="regla: adjord nom adj: terza Guerra Mondiale > de tres Gherras Mondiales, Terza Guerra Mondiale > Sa de tres Gherras Mondiales">
       <pattern>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
     <choose>
       <when>
         <test>
	    <and>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="primu"/></equal></not>
	    <not><equal caseless="yes"><clip pos="1" side="tl" part="lem"/><lit v="segundu"/></equal></not>
           <equal>
             <case-of pos="1" side="sl" part="lemh"/>
             <lit v="Aa"/>
           </equal>
	    </and>
           </test>
           <!-- considerem que és inici de frase (comença amb majúscula i no hi ha article: no es "la Tercera República" -->
           <!-- afegim l'article -->
           <modify-case>
             <clip pos="1" side="tl" part="lemh"/>
             <lit v="aa"/>
           </modify-case>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
               <lit v="Su"/><lit-tag v="det"/><lit-tag v="def"/>
               <clip pos="2" side="tl" part="gen"/>
               <lit-tag v="sg"/>
           </lu>
           <b/>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </otherwise>
     </choose>
       </action>
    </rule>


    <rule comment="regla: adjord adj nom: terza gran casa > de tres grandes domos">
       <pattern>
         <pattern-item n="adjord"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adjord_adj_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos adjord nom > adjord nom adjpos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adjord_n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos num nom > num nom adjpos: suoi due figli > duos fìgios suos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="num"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="num_n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos num nom adj > num nom adj adjpos: suoi due figli intelligenti > duos fìgios intelligentes suos">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="num"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="num_n__adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjpos num adj nom > num adj nom adjpos: le sue due principali fonti > sas duas printzipales fontes suas">
       <pattern>
         <pattern-item n="adjpos"/>
         <pattern-item n="num"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="4"/>
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="num_n__adj_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjord nom: la terza casa > sa de tres domos">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
	         <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="f"/></equal>
	         <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
                 <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="mese"/></in>
               </and>
             </test>
	     <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
	     <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
           </when>
         </choose>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjord adj nom: la terza gran casa > sa de tres grandes domos">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjord"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="det_adjord_adj_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjpos adjord nom > det adjord nom adjpos">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjpos"/>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="det_adjord_n_adjpos">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjord nom adj: il terzo anno consecutivo > su de tres annos consecutivos">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="det_adjord_n_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: pr adjord nom: di terzo livello > de su de tres livellos">
       <pattern>
         <pattern-item n="pr"/>
         <pattern-item n="adjord"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp"> <!-- expandir pl de adjord -->
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <or>
                 <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal>
                 <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal>
               </or>
             </test>
             <out>
               <chunk name="pr_adjord_n">
                 <tags>
                   <tag><lit-tag v="SPrep"/></tag>
                 </tags>
                 <lu>
                   <clip pos="1" side="tl" part="lemh"/>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
                 <b pos="2"/>
                 <lu>
                   <clip pos="3" side="tl" part="lemh"/>
                   <clip pos="3" side="tl" part="tags"/>
                   <clip pos="3" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </when>
           <otherwise>
             <out>
               <chunk name="pr_det_adjord_n">
                 <tags>
                   <tag><lit-tag v="SPrep"/></tag>
                 </tags>
                 <lu>
                   <clip pos="1" side="tl" part="lemh"/>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
                 <b/>
                 <lu>
                   <lit v="su"/>
                   <lit-tag v="det"/><lit-tag v="def"/>
                   <var n="genero"/>
                   <var n="numero"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
                 <b pos="2"/>
                 <lu>
                   <clip pos="3" side="tl" part="lemh"/>
                   <clip pos="3" side="tl" part="tags"/>
                   <clip pos="3" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </otherwise>
         </choose>
       </action>
    </rule>


    <rule comment="regla: adjsup nom">
       <pattern>
         <pattern-item n="adjsup"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
	  <let>
	    <clip pos="1" side="tl" part="a_adj_sup"/>
	    <lit-tag v="adj"/>
	  </let>
         <out>
           <chunk name="adjsup_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b/>
           <lu>
             <lit v="meda"/><lit-tag v="adv"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: nom adjec">
       <pattern>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="n_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: nom adjsup">
       <pattern>
         <pattern-item n="nom"/>
         <pattern-item n="adjsup"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
	     <let>
	       <clip pos="2" side="tl" part="a_adj_sup"/>
	       <lit-tag v="adj"/>
	     </let>
         <out>
           <chunk name="n_adjsup">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="meda"/><lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom adjec">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="det_n_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom adjsup">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjsup"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
	  <let>
	    <clip pos="3" side="tl" part="a_adj_sup"/>
	    <lit-tag v="adj"/>
	  </let>
         <out>
           <chunk name="det_n_adjsup">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
                 <lit v="meda"/><lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom pp si">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="pp"/>
         <pattern-item n="si-enc"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_carchi2">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord1">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="det_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="2"/>
           <chunk name="pp+si">
             <tags>
               <tag><lit-tag v="PP"/></tag>
             </tags>
             <mlu>
               <lu>
                 <lit v="àere"/>
                 <lit-tag v="vbhaver.ger"/>
               </lu>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="tags"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
             </mlu>
             <b/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


<rule comment="regla: det adjec nom">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_chunk_tags">
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="f_reord_adj">
      <with-param pos="3"/>
      <with-param pos="2"/>
    </call-macro>
    <choose>
      <when>
        <test>
          <and>
            <equal><clip pos="2" side="tl" part="a_adj_ord"/><lit-tag v="adj.ord"/></equal>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="primu"/></equal></not>
            <not><equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="segundu"/></equal></not>
           <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
          </and>
        </test>
        <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
      </when>
    </choose>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <out>
          <chunk name="det-adj-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero_tl"/></tag>
              <tag><var n="numero_tl"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="unu_num"/>	<!-- to avoid un' -->
               <lit-tag v="num"/>
               <var n="genero"/>
               <lit-tag v="sp"/>
             </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
         <chunk name="det-adj-nom">
           <tags>
             <tag><lit-tag v="SN"/></tag>
             <tag><var n="genero_tl"/></tag>
             <tag><var n="numero_tl"/></tag>
             <tag><var n="genero_sl"/></tag>
             <tag><var n="numero_sl"/></tag>
           </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </otherwise>
    </choose>
  </action>
</rule>


    <rule comment="regla: det adjsup nom">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjsup"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
	     <let>
	       <clip pos="2" side="tl" part="a_adj_sup"/>
	       <lit-tag v="adj"/>
	     </let>
         <out>
           <chunk name="det_adjsup_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="meda"/><lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom adv adjec">
       <pattern>
         <pattern-item n="det_num"/>
         <pattern-item n="nom"/>
         <pattern-item n="adv-preadv"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
     <choose>
       <when>
         <test>
          <in caseless="yes"><clip pos="3" side="tl" part="lemh"/><list n="adv_post"/></in>
         </test>
         <out>
           <chunk name="det_n_adv_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="det_n_adv_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
       </action>
    </rule>


    <rule comment="regla: det adv adjec nom">
       <pattern>
         <pattern-item n="det_num"/>
         <pattern-item n="adv-preadv"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_carchi3">
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="4"/>
         </call-macro>
     <choose>
       <when>
         <test>
          <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="adv_post"/></in>
         </test>
         <out>
           <chunk name="det_adv_adj_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="4" side="tl" part="gen"/></tag>
               <tag><clip pos="4" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="det_adv_adj_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="4" side="tl" part="gen"/></tag>
               <tag><clip pos="4" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
       </action>
    </rule>


    <rule comment="regla: det nom adjec adjec">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="det_n_adj_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom adjec adjsup">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjsup"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
	     <let>
	       <clip pos="4" side="tl" part="a_adj_sup"/>
	       <lit-tag v="adj"/>
	     </let>
         <out>
           <chunk name="det_n_adj_adjsup">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="meda"/><lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det nom adjec adjec adjec">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord5">
           <with-param pos="2"/>
           <with-param pos="1"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="2"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_carchi5">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="det_n_adj_adj_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjec nom adjec">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_reord_adj3">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="det_adj_n_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjec nom adjsup">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjsup"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_carchi4">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_reord_adj">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
	     <let>
	       <clip pos="4" side="tl" part="a_adj_sup"/>
	       <lit-tag v="adj"/>
	     </let>
         <out>
           <chunk name="det_adj_n_adjsup">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><var n="genero_tl"/></tag>
               <tag><var n="numero_tl"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="meda"/><lit-tag v="adv"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: det adjec nom adjec adjec">
       <pattern>
         <pattern-item n="det"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord5">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_carchi5">
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_reord_adj4">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="det_adj_n_adj_adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: predet det nom">
       <pattern>
         <pattern-item n="predet"/>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="predet-det-nom">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: predet det nom adjec">
       <pattern>
         <pattern-item n="predet"/>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="predet-det-nom-adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: predet det nom adjec adjec">
       <pattern>
         <pattern-item n="predet"/>
         <pattern-item n="det"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord5">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="5"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="3"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="3"/>
         </call-macro>
         <out>
           <chunk name="predet-det-nom-adj-adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


<rule comment="regla: det num nom">
   <pattern>
     <pattern-item n="det"/>
     <pattern-item n="num"/>
     <pattern-item n="nom"/>
   </pattern>
   <action>
     <call-macro n="f_concord3">
       <with-param pos="3"/>
       <with-param pos="2"/>
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_concord_esp">
       <with-param pos="3"/>
       <with-param pos="2"/>
     </call-macro>
     <call-macro n="f_concord_esp">
       <with-param pos="3"/>
       <with-param pos="1"/>
     </call-macro>
     <call-macro n="f_chunk_tags">
       <with-param pos="3"/>
     </call-macro>
     <choose>
       <when>
         <test>
           <and>
             <in><clip pos="2" side="sl" part="lemh"/><list n="numrom"/></in>
             <equal caseless="yes"><clip pos="3" side="sl" part="lem"/><lit v="secolo"/></equal>
           </and>
         </test>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>

       <when>
         <test>
           <in><clip pos="2" side="sl" part="lemh"/><list n="numrom"/></in>
         </test>
         <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></let>
         <out>
           <chunk name="det_adjord_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <lit v="de"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>

      <when>
        <test>
          <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <choose>
          <when>
            <test>
	      <equal caseless="yes"><clip pos="1" side="sl" part="lemh"/><lit v="un"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="lemh"/><lit v="su"/></let>
            <let><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></let>
          </when>
        </choose>
        <out>
          <chunk name="det-nom-num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </when>

       <otherwise>
         <choose>
           <when>
             <test>
               <and>
                 <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></equal>
                 <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="f"/></equal>
                 <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="mese"/></in>
               </and>
             </test>
             <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
           </when>
         </choose>
         <out>
           <chunk name="det-num-nom">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="3" side="tl" part="gen"/></tag>
               <tag><clip pos="3" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


    <rule comment="regla: predet det num nom">
       <pattern>
         <pattern-item n="predet"/>
         <pattern-item n="det"/>
         <pattern-item n="num"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord4">
           <with-param pos="4"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="predet-det-num-nom">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="4" side="tl" part="gen"/></tag>
               <tag><clip pos="4" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: predet det num nom adjec">
       <pattern>
         <pattern-item n="predet"/>
         <pattern-item n="det"/>
         <pattern-item n="num"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord5">
           <with-param pos="4"/>
           <with-param pos="5"/>
           <with-param pos="1"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="5"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="predet-det-num-nom-adj">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="4" side="tl" part="gen"/></tag>
               <tag><clip pos="4" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="tags"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <!-- ============================= SV ================================= -->

    <rule comment="regla: pprs">
       <pattern>
         <pattern-item n="pprs"/>
       </pattern>
       <action>

         <out>
           <chunk name="chi_pri">
             <tags>
               <tag><lit-tag v="SRel"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="chi"/>
                 </get-case-from>
                 <lit-tag v="rel.an.mf.sp"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pri.p3"/>
                 <clip pos="1" side="tl" part="nbr"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: pp si">
       <pattern>
         <pattern-item n="pp"/>
         <pattern-item n="si-enc"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="pp+si">
             <tags>
               <tag><lit-tag v="PP"/></tag>
             </tags>
               <mlu>
               <lu>
                 <get-case-from pos="1">
                 <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.ger"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               </mlu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
<!-- traducció alternativa
           <chunk name="chi_pri">
             <tags>
               <tag><lit-tag v="SRel"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="chi"/>
                 </get-case-from>
                 <lit-tag v="rel.an.mf.sp"/>
               </lu>
               <b/>
               <lu>
                 <lit v="si"/>
                 <lit-tag v="prn.pro.ref.p3.mf.sp"/>
               </lu>
               <b/>
               <lu>
                 <lit v="èssere"/>
                 <lit-tag v="vbser.pri.p3"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pp"/>
                 <clip pos="1" side="tl" part="gen"/>
                 <clip pos="1" side="tl" part="nbr"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
-->
         </out>
       </action>
    </rule>


    <rule comment="regla: pp lo">
       <pattern>
         <pattern-item n="pp"/>
         <pattern-item n="lo-enc"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="pp+lo">
             <tags>
               <tag><lit-tag v="PP"/></tag>
             </tags>
               <mlu>
               <lu>
                 <get-case-from pos="1">
                 <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.ger"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               </mlu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
<!-- traducció alternativa
           <chunk name="chi_pri">
             <tags>
               <tag><lit-tag v="SRel"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="chi"/>
                 </get-case-from>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               </mlu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
-->
         </out>
       </action>
    </rule>


    <rule comment="regla: pp lo a inf">
       <pattern>
         <pattern-item n="pp"/>
         <pattern-item n="lo-enc"/>
         <pattern-item n="a"/>
         <pattern-item n="vblex_inf"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pp_a_inf">
             <tags>
               <tag><lit-tag v="PP"/></tag>
             </tags>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="tags"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: c'è"> <!-- c'è > b'at, c'erano > b'at (tots els temps simples de l'italià)-->
       <pattern>
         <pattern-item n="ci"/>
         <pattern-item n="essere-p3"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
	 <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-ifi">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pri"/>
                 <clip pos="2" side="tl" part="pers"/>
                 <clip pos="2" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pp.m.sg"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-fti">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-cni">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.inf"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
	</when>

	<otherwise>
         <out>
           <chunk name="b'at">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="àere"/>
                 </get-case-from>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</otherwise>
      </choose>
       </action>
    </rule>


    <rule comment="regla: c'è dei"> <!-- c'è del > b'at, c'erano > b'at (tots els temps simples de l'italià) (exactament igual que l'anterior, eliminant el partitiu) -->
       <pattern>
         <pattern-item n="ci"/>
         <pattern-item n="essere-p3"/>
         <pattern-item n="di"/>
         <pattern-item n="detdef"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
	 <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vbhaver"/></let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
	  </test>
	  <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-ifi">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pri"/>
                 <clip pos="2" side="tl" part="pers"/>
                 <clip pos="2" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pp.m.sg"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-fti">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-cni">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.inf"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
	</when>

	<otherwise>
         <out>
           <chunk name="b'at">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="àere"/>
                 </get-case-from>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</otherwise>
      </choose>
         <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
         <call-macro n="f_bcond"><with-param pos="2"/><with-param pos="3"/></call-macro>
       </action>
    </rule>


    <rule comment="regla: c'è stato"> <!-- c'è > b'est istado (tots els temps simples de l'italià))-->
       <pattern>
         <pattern-item n="ci"/>
         <pattern-item n="essere-p3"/>
         <pattern-item n="essere-pp"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="3"/>
         </call-macro>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-ifi">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pri"/>
                 <clip pos="2" side="tl" part="pers"/>
                 <clip pos="2" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pp.m.sg"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-fti">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="èssere"/>
               </get-case-from>
               <lit-tag v="vbser.inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</when>

	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </equal>
	  </test>
         <out>
           <chunk name="b'at-cni">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
               <lit v="bi"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="èssere"/>
               </get-case-from>
               <lit-tag v="vbser.inf"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</when>

	<otherwise>
         <out>
           <chunk name="b'at">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                 <lit v="bi"/>
                 </get-case-from>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
	</otherwise>
      </choose>
       </action>
    </rule>


<rule comment="regla: pro ifi (si arricchì > si fiat arrichidu)">
   <pattern>
     <pattern-item n="pro"/>
     <pattern-item n="ifi"/>
   </pattern>
   <action>
     <choose>
       <when>
         <test>
           <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="GD"/></equal>
         </test>
         <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
       </when>
     </choose>
     <choose>
       <when>
         <test>
           <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
         </test>
         <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
       </when>
     </choose>
     <out>
       <chunk name="pro">
         <tags>
           <tag><lit-tag v="SPron"/></tag>
         </tags>
         <lu>
           <clip pos="1" side="tl" part="lemh"/>
           <clip pos="1" side="tl" part="tags"/>
           <clip pos="1" side="tl" part="lemq"/>
         </lu>
       </chunk>
       <b pos="1"/>
     </out>

     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="2" side="tl" part="lemh"/><list n="vbambser"/></in>
             <and>
               <equal caseless="yes"><clip pos="2" side="tl" part="lemh"/><lit v="torrare"/></equal>
               <equal><clip pos="2" side="tl" part="lemq"/><lit v=""/></equal>
             </and>
             <and>
               <not><equal><clip pos="2" side="sl" part="pers"/><lit-tag v="p3"/></equal></not>
               <equal><clip pos="1" side="sl" part="pers"/><clip pos="2" side="sl" part="pers"/></equal>
               <or>
                 <equal><clip pos="1" side="sl" part="nbr"/><clip pos="2" side="sl" part="nbr"/></equal>
                 <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
               </or>
             </and>
             <and>
               <equal><clip pos="2" side="sl" part="pers"/><lit-tag v="p3"/></equal>
               <equal caseless="yes"><clip pos="1" side="sl" part="lem"/><lit v="si"/></equal>
             </and>
           </or>
         </test>
         <out>
           <chunk name="èssere">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><lit-tag v="vbser"/></tag>
               <tag><lit-tag v="pii"/></tag>
             </tags>
             <lu>
               <get-case-from pos="2">
                 <lit v="èssere"/>
               </get-case-from>
               <lit-tag v="vbser.pii"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
           </chunk>
           <b/>
         </out>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="2" side="tl" part="a_verb"/></tag>
               <tag><lit-tag v="pp"/></tag>
               <tag><lit-tag v="GD"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="a_verb"/>
               <lit-tag v="pp"/>
               <lit-tag v="4"/>
               <lit-tag v="5"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="àere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="2">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="2" side="tl" part="pers"/>
                 <clip pos="2" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_verb"/>
                 <lit-tag v="pp.m.sg"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<rule comment="regla: ifi > èssere/àere pp">
   <pattern>
     <pattern-item n="ifi"/>
   </pattern>
   <action>
     <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
     <choose>
       <when>
         <test>
           <or>
             <in caseless="yes"><clip pos="1" side="tl" part="lemh"/><list n="vbambser"/></in>
             <and>
               <equal caseless="yes"><clip pos="1" side="tl" part="lemh"/><lit v="torrare"/></equal>
               <equal><clip pos="1" side="tl" part="lemq"/><lit v=""/></equal>
             </and>
           </or>
         </test>
         <out>
           <chunk name="èssere">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><lit-tag v="vbser"/></tag>
               <tag><lit-tag v="pii"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="èssere"/>
               </get-case-from>
               <lit-tag v="vbser.pii"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
           </chunk>
           <b/>
         </out>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="1" side="tl" part="a_verb"/></tag>
               <tag><lit-tag v="pp"/></tag>
               <tag><lit-tag v="GD"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp"/>
               <lit-tag v="4"/>
               <lit-tag v="5"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="àere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="àere"/>
                 </get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pp.m.sg"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>


<!--
    <rule comment="regla: vbser_ifi">
       <pattern>
         <pattern-item n="vbser_ifi"/>
       </pattern>
       <action>
         <modify-case>
           <clip pos="1" side="tl" part="lem"/>
           <lit v="aa"/>
         </modify-case>
         <out>
           <chunk name="èssere_pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1">
                   <lit v="èssere"/>
                 </get-case-from>
                 <lit-tag v="vbser.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="pp.m.sg"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>
-->


    <rule comment="regla: fti > àere a inf">
       <pattern>
         <pattern-item n="fti"/>
       </pattern>
       <action>
         <modify-case>
           <clip pos="1" side="tl" part="lem"/>
           <lit v="aa"/>
         </modify-case>
         <out>
           <chunk name="àere_a_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: cni > dare.prs inf">
       <pattern>
         <pattern-item n="cni"/>
       </pattern>
       <action>
         <modify-case>
           <clip pos="1" side="tl" part="lem"/>
           <lit v="aa"/>
         </modify-case>
         <out>
           <chunk name="mod-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <!-- _____________________________ essere meglio inf >  èssere mègius a inf _________________________________ -->

    <rule comment="regla: essere.ifi meglio inf > èssere èssere.pp mègius a inf: fu meglio lavorare > fiat istadu mègius a traballare">
       <pattern>
         <pattern-item n="essere-ifi"/>
         <pattern-item n="meglio"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
         <out>
           <chunk name="èssere">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><lit-tag v="vbser"/></tag>
               <tag><lit-tag v="pii"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="èssere"/>
               </get-case-from>
               <lit-tag v="vbser.pii"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
           </chunk>
           <b/>
         </out>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="pp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="1" side="tl" part="a_verb"/></tag>
               <tag><lit-tag v="pp"/></tag>
               <tag><lit-tag v="GD"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp"/>
               <lit-tag v="4"/>
               <lit-tag v="5"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
         </out>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adj">
             <tags>
               <tag><lit-tag v="SA"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="a_adjec"/>
               <lit-tag v="2"/>
               <lit-tag v="3"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="2"/>
           <chunk name="pr">
             <tags>
               <tag><lit-tag v="pr"/></tag>
             </tags>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
           </chunk>
           <b/>
         </out>
         <modify-case><clip pos="3" side="tl" part="lem"/><lit v="aa"/></modify-case>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="3" side="tl" part="a_verb"/></tag>
               <tag><clip pos="3" side="tl" part="temps"/></tag>
             </tags>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b/>
         </out>
       </action>
    </rule>

    <rule comment="regla: essere.fti meglio inf > àere a èssere.inf mègius a inf: sarà meglio lavorare > at a èssere mègius a traballare">
       <pattern>
         <pattern-item n="essere-fti"/>
         <pattern-item n="meglio"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <modify-case>
           <clip pos="1" side="tl" part="lem"/>
           <lit v="aa"/>
         </modify-case>
         <out>
           <chunk name="àere_a_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: essere.cni meglio inf > dare.prs èssere.inf mègius a inf: sarebbe meglio lavorare > diat èssere mègius a traballare">
       <pattern>
         <pattern-item n="essere-cni"/>
         <pattern-item n="meglio"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <modify-case>
           <clip pos="1" side="tl" part="lem"/>
           <lit v="aa"/>
         </modify-case>
         <out>
           <chunk name="mod-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: essere meglio inf > èssere mègius a inf">
       <pattern>
         <pattern-item n="essere"/>
         <pattern-item n="meglio"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <call-macro n="modif_case">
           <with-param pos="1"/>
         </call-macro>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="1" side="tl" part="a_verb"/></tag>
               <tag><clip pos="1" side="tl" part="temps"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/><lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <!-- ============================= PRN ================================= -->

    <rule comment="regla: gli pro">
       <pattern>
         <pattern-item n="gli"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="gli"/></tag>
             </tags>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
           <b/>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="enc"/></tag>
             </tags>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: imper-ger-pp enc">
       <pattern>
         <pattern-item n="imper-ger-pp"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <out>
           <chunk name="verb_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <mlu>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lem"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
             </mlu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: imper-ger-pp enc enc">
       <pattern>
         <pattern-item n="imper-ger-pp"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <out>
           <chunk name="verb_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <mlu>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lem"/>
                 <clip pos="2" side="tl" part="tags"/>
               </lu>
               <lu>
                 <clip pos="3" side="tl" part="lem"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
             </mlu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: inf enc">
       <pattern>
         <pattern-item n="inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <modify-case><clip pos="2" side="tl" part="lemh"/><case-of pos="1" side="sl" part="lemh"/></modify-case>
         <modify-case><clip pos="1" side="tl" part="lemh"/><case-of pos="2" side="sl" part="lemh"/></modify-case>
         <out>
           <chunk name="inf_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: inf enc enc (dirglielo > bi lu nàrrere ; trasferirvisi > si nche tramudare">
       <pattern>
         <pattern-item n="inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="2" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <modify-case><clip pos="2" side="tl" part="lemh"/><case-of pos="1" side="sl" part="lemh"/></modify-case>
         <modify-case><clip pos="1" side="tl" part="lemh"/><case-of pos="2" side="sl" part="lemh"/></modify-case>
         <choose>
           <when>
             <test>
               <and>
                 <equal><clip pos="2" side="sl" part="lem"/><lit v="ci"/></equal>
                 <equal><clip pos="2" side="sl" part="tipus_prn"/><lit-tag v="prn.enc.adv"/></equal>
               </and>
             </test>
             <out>
               <chunk name="inf_enc">
                 <tags>
                   <tag><lit-tag v="SV"/></tag>
                 </tags>
                   <lu>
                     <clip pos="3" side="tl" part="lemh"/>
                     <clip pos="3" side="tl" part="tags"/>
                     <clip pos="3" side="tl" part="lemq"/>
                   </lu>
                   <b/>
                   <lu>
                     <clip pos="2" side="tl" part="lemh"/>
                     <clip pos="2" side="tl" part="tags"/>
                     <clip pos="2" side="tl" part="lemq"/>
                   </lu>
                   <b/>
                   <lu>
                     <clip pos="1" side="tl" part="lemh"/>
                     <clip pos="1" side="tl" part="tags"/>
                     <clip pos="1" side="tl" part="lemq"/>
                   </lu>
               </chunk>
             </out>
           </when>
           <otherwise>
             <out>
               <chunk name="inf_enc">
                 <tags>
                   <tag><lit-tag v="SV"/></tag>
                 </tags>
                   <lu>
                     <clip pos="2" side="tl" part="lemh"/>
                     <clip pos="2" side="tl" part="tags"/>
                     <clip pos="2" side="tl" part="lemq"/>
                   </lu>
                   <b/>
                   <lu>
                     <clip pos="3" side="tl" part="lemh"/>
                     <clip pos="3" side="tl" part="tags"/>
                     <clip pos="3" side="tl" part="lemq"/>
                   </lu>
                   <b/>
                   <lu>
                     <clip pos="1" side="tl" part="lemh"/>
                     <clip pos="1" side="tl" part="tags"/>
                     <clip pos="1" side="tl" part="lemq"/>
                   </lu>
               </chunk>
             </out>
           </otherwise>
         </choose>
       </action>
    </rule>

    <rule comment="regla: vbmod-tmp-srd inf enc">
       <pattern>
         <pattern-item n="vbmod-tmp-srd"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_vbmod_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <clip pos="3" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: vbmod-ifi inf enc">
       <pattern>
         <pattern-item n="vbmod-ifi"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aere_vbmodpp_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pii"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp.m.sg"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-fti inf enc">
       <pattern>
         <pattern-item n="vbmod-fti"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aux-a-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-cni inf enc">
       <pattern>
         <pattern-item n="vbmod-cni"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="pro_aux-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-tmp-srd inf enc enc">
       <pattern>
         <pattern-item n="vbmod-tmp-srd"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <choose>
           <when>
             <test>
               <and>
                 <equal><clip pos="3" side="sl" part="lem"/><lit v="ci"/></equal>
                 <equal><clip pos="3" side="sl" part="tipus_prn"/><lit-tag v="prn.enc.adv"/></equal>
               </and>
             </test>
             <out>
               <chunk name="pro_pro_vbmod_inf">
                 <tags>
                   <tag><lit-tag v="SV"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <clip pos="4" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="4" side="tl" part="tags"/>
                   <clip pos="4" side="tl" part="lemq"/>
                 </lu>
                 <b/>
                 <lu>
                   <clip pos="3" side="tl" part="lemh"/>
                   <clip pos="3" side="tl" part="tags"/>
                   <clip pos="3" side="tl" part="lemq"/>
                 </lu>
                 <b/>
                 <lu>
                   <get-case-from pos="2">
                     <clip pos="1" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </when>
           <otherwise>
             <out>
               <chunk name="pro_pro_vbmod_inf">
                 <tags>
                   <tag><lit-tag v="SV"/></tag>
                 </tags>
                 <lu>
                   <get-case-from pos="1">
                     <clip pos="3" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="3" side="tl" part="tags"/>
                   <clip pos="3" side="tl" part="lemq"/>
                 </lu>
                 <b/>
                 <lu>
                   <clip pos="4" side="tl" part="lemh"/>
                   <clip pos="4" side="tl" part="tags"/>
                   <clip pos="4" side="tl" part="lemq"/>
                 </lu>
                 <b/>
                 <lu>
                   <get-case-from pos="2">
                     <clip pos="1" side="tl" part="lemh"/>
                   </get-case-from>
                   <clip pos="1" side="tl" part="tags"/>
                   <clip pos="1" side="tl" part="lemq"/>
                 </lu>
                 <b pos="1"/>
                 <lu>
                   <clip pos="2" side="tl" part="lemh"/>
                   <clip pos="2" side="tl" part="tags"/>
                   <clip pos="2" side="tl" part="lemq"/>
                 </lu>
               </chunk>
             </out>
           </otherwise>
         </choose>
       </action>
    </rule>


    <rule comment="regla: vbmod-ifi inf enc enc">
       <pattern>
         <pattern-item n="vbmod-ifi"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <choose>
           <when>
             <test>
               <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
             </test>
            <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
            <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
            <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
           </when>
         </choose>
         <out>
           <chunk name="pro_pro_aere_vbmodpp_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pii"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="pp.m.sg"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-fti inf enc enc">
       <pattern>
         <pattern-item n="vbmod-fti"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when>
      </choose>
         <out>
           <chunk name="pro_aux-a-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vblex.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <lit v="a"/>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: vbmod-cni inf enc enc">
       <pattern>
         <pattern-item n="vbmod-cni"/>
         <pattern-item n="vblex_inf"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="4" side="sl" part="lem"/><lit v="li"/></equal>
	  </test>
	 <!-- corregim una anàlisi errònea de fomes com me'l, en què el segon component s'analitza com a CI, en comptes de com a CD -->
         <let><clip pos="4" side="tl" part="lem"/><lit v="lu"/></let>
         <let><clip pos="4" side="tl" part="gen"/><lit-tag v="m"/></let>
	</when>
      </choose>
         <out>
           <chunk name="pro_aux-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
             <get-case-from pos="1">
               <clip pos="3" side="tl" part="lemh"/>
             </get-case-from>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
                 <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: verb loro (parlo loro > lis faeddo)">
       <pattern>
         <pattern-item n="verb"/>
         <pattern-item n="loro_pro"/>
       </pattern>
       <action>
         <out>
           <chunk name="tn">
             <tags>
               <tag><lit-tag v="SPron"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
           <lu>
             <get-case-from pos="2">
               <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: stare ger (stava combattendo > fiat cumbatende)">
       <pattern>
         <pattern-item n="stare"/>
         <pattern-item n="ger"/>
       </pattern>
       <action>
	  <let><clip pos="1" side="tl" part="lemh"/><lit v="èssere"/></let>
	  <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: stare adv ger (stava sempre combattendo > fiat semper cumbatende)">
       <pattern>
         <pattern-item n="stare"/>
         <pattern-item n="adv"/>
         <pattern-item n="ger"/>
       </pattern>
       <action>
	  <let><clip pos="1" side="tl" part="lemh"/><lit v="èssere"/></let>
	  <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vbser"/></let>
         <out>
           <chunk name="v">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: pr prn (Norme p. 28)">
       <pattern>
         <pattern-item n="pr"/>
         <pattern-item n="tn-pers"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_pr_tn-pers">
           <with-param pos="1"/>
           <with-param pos="2"/>
         </call-macro>

         <out>
           <chunk name="pr">
             <tags>
               <tag><lit-tag v="pr"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="tn">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: quello che">
       <pattern>
         <pattern-item n="quello"/>
         <pattern-item n="che"/>
       </pattern>
       <action>
       <choose>
	 <when>
	   <test>
	     <or>
	       <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="nt"/></equal>
	       <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="GD"/></equal>
	     </or>
	   </test>
	   <let><clip pos="1" side="tl" part="gen"/><var n="genero"/></let>
	 </when>
       </choose>
         <out>
           <chunk name="su_chi">
             <tags>
               <tag><lit-tag v="rel"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1"><lit v="su chi"/></get-case-from>
             <lit-tag v="rel.an"/>
             <clip pos="1" side="tl" part="gen"/>
             <clip pos="1" side="sl" part="nbr"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: per tutto il nom > totu su nom">
       <pattern>
         <pattern-item n="per"/>
         <pattern-item n="tutto_predet"/>
         <pattern-item n="il_det_sg"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="4"/>
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord_esp">
           <with-param pos="4"/>
           <with-param pos="3"/>
         </call-macro>

         <out>
           <chunk name="totu_su_n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: non imp > non pri">
       <pattern>
         <pattern-item n="non"/>
         <pattern-item n="imper"/>
       </pattern>
       <action>
	 <let><clip pos="2" side="tl" part="temps"/><lit-tag v="prs"/></let>
         <out>
           <chunk name="non_imper">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: non imp enc > non pro pri">
       <pattern>
         <pattern-item n="non"/>
         <pattern-item n="imper"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
	 <let><clip pos="2" side="tl" part="temps"/><lit-tag v="prs"/></let>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="non_imper_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: non imp enc enc > non pro pro pri">
       <pattern>
         <pattern-item n="non"/>
         <pattern-item n="imper"/>
         <pattern-item n="enc"/>
         <pattern-item n="enc"/>
       </pattern>
       <action>
	 <let><clip pos="2" side="tl" part="temps"/><lit-tag v="prs"/></let>
         <let><clip pos="3" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <let><clip pos="4" side="tl" part="a_prn"/><lit-tag v="prn.pro"/></let>
         <out>
           <chunk name="non_imper_enc_enc">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="tags"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="tags"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="tags"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: come migliore/peggiore n > comente det.def mègius/peus n">
       <pattern>
         <pattern-item n="come-pr"/>
         <pattern-item n="migliore_peggiore"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pr-adj-n">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
               <lit v="su"/>
             </get-case-from>
             <lit-tag v="det.def"/>
             <var n="genero"/>
             <var n="numero"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: come migliore/peggiore adj n > comente det.def mègius/peus adj n">
       <pattern>
         <pattern-item n="come-pr"/>
         <pattern-item n="migliore_peggiore"/>
         <pattern-item n="adjec"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="4"/>
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pr-adj-adj-n">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
               <lit v="su"/>
             </get-case-from>
             <lit-tag v="det.def"/>
             <var n="genero"/>
             <var n="numero"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: come migliore/peggiore n adj > comente det.def mègius/peus n adj">
       <pattern>
         <pattern-item n="come-pr"/>
         <pattern-item n="migliore_peggiore"/>
         <pattern-item n="nom"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord3">
           <with-param pos="3"/>
           <with-param pos="4"/>
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="pr-adj-n-adj">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
               <lit v="su"/>
             </get-case-from>
             <lit-tag v="det.def"/>
             <var n="genero"/>
             <var n="numero"/>
           </lu>
           <b/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: così adj/adv come > adj/adv comente a">
       <pattern>
         <pattern-item n="così"/>
         <pattern-item n="adjec-adv"/>
         <pattern-item n="come-reladv"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="così-adj/adv-come">
             <tags>
               <tag><lit-tag v="SA"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <get-case-from pos="3">
             <lit v="comente a"/>
             </get-case-from>
             <lit-tag v="rel.adv"/>
           </lu>
<!--
           <b/>
           <lu>
             <get-case-from pos="3">
             <lit v="a"/>
             </get-case-from>
             <lit-tag v="pr"/>
           </lu>
-->
         </chunk>
         </out>
       </action>
    </rule>

<!--
    <rule comment="regla: adj/adv come > adj/adv comente a">
       <pattern>
         <pattern-item n="adjec-adv"/>
         <pattern-item n="come-reladv"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="adj/adv-come">
             <tags>
               <tag><lit-tag v="SA"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="comente"/>
             </get-case-from>
             <lit-tag v="cnjadv"/>
           </lu>
           <b/>
           <lu>
             <get-case-from pos="2">
             <lit v="a"/>
             </get-case-from>
             <lit-tag v="pr"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>
-->

    <rule comment="regla: tanto adj/adv quanto > adj/adv cantu a">
       <pattern>
         <pattern-item n="tanto"/>
         <pattern-item n="adjec-adv"/>
         <pattern-item n="quanto-cnjadv"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="tanto-adj/adv-quanto">
             <tags>
               <tag><lit-tag v="SA"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <get-case-from pos="3">
             <lit v="cantu"/>
             </get-case-from>
             <lit-tag v="cnjadv"/>
           </lu>
           <b/>
           <lu>
             <get-case-from pos="3">
             <lit v="a"/>
             </get-case-from>
             <lit-tag v="pr"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: più adj/adv che > prus adj/adv chi">
       <pattern>
         <pattern-item n="più-meno"/>
         <pattern-item n="adjec-adv"/>
         <pattern-item n="che"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="più-adj/adv-chi">
             <tags>
               <tag><lit-tag v="SA"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <get-case-from pos="3">
             <lit v="chi"/>
             </get-case-from>
             <lit-tag v="cnjsub"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: più adj/adv inf che > prus adj/adv inf chi">
       <pattern>
         <pattern-item n="più-meno"/>
         <pattern-item n="adjec-adv"/>
         <pattern-item n="inf"/>
         <pattern-item n="che"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="più-adj/adv-inf-chi">
             <tags>
               <tag><lit-tag v="SA"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="2" side="tl" part="lemh"/>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="3" side="tl" part="lemh"/>
             <clip pos="3" side="tl" part="tags"/>
             <clip pos="3" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <get-case-from pos="3">
             <lit v="chi"/>
             </get-case-from>
             <lit-tag v="cnjsub"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: proprio prnpers > prnpers etotu">
       <pattern>
         <pattern-item n="proprio_adv"/>
         <pattern-item n="prnpers"/>
       </pattern>
       <action>
         <out>
           <chunk name="prnpers-etotu">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
             <lit v="etotu"/>
             </get-case-from>
             <lit-tag v="adv"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: proprio a np > a np etotu">
       <pattern>
         <pattern-item n="proprio_adv"/>
         <pattern-item n="a_in"/>
         <pattern-item n="np_unk"/>
       </pattern>
       <action>
         <out>
           <chunk name="a-np-etotu">
             <tags>
               <tag><lit-tag v="SPrep"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="whole"/>
           </lu>
           <b pos="2"/>
           <lu>
             <get-case-from pos="2">
             <lit v="etotu"/>
             </get-case-from>
             <lit-tag v="adv"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: proprio a np np > a np np etotu">
       <pattern>
         <pattern-item n="proprio_adv"/>
         <pattern-item n="a"/>
         <pattern-item n="np_unk"/>
         <pattern-item n="np_unk"/>
       </pattern>
       <action>
         <out>
           <chunk name="a-np-np-etotu">
             <tags>
               <tag><lit-tag v="SPrep"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
             <clip pos="2" side="tl" part="lem"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="whole"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="4" side="tl" part="whole"/>
           </lu>
           <b pos="3"/>
           <lu>
             <get-case-from pos="2">
             <lit v="etotu"/>
             </get-case-from>
             <lit-tag v="adv"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: verb + di-nuovo > torrare a + verb">
       <pattern>
         <pattern-item n="verb-tmp-srd"/>
         <pattern-item n="di_nuovo"/>
       </pattern>
       <action>
         <out>
           <chunk name="verb_dinuovo">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="torrare"/></get-case-from>
               <lit-tag v="vblex"/>
               <clip pos="1" side="tl" part="temps"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2">
               <lit v="a"/>
               </get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2">
               <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: verb + enc + di-nuovo > torrare a + verb">
       <pattern>
         <pattern-item n="verb-tmp-srd"/>
         <pattern-item n="enc"/>
         <pattern-item n="di_nuovo"/>
       </pattern>
       <action>
         <out>
           <chunk name="verb_dinuovo">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <mlu>
               <lu>
                 <get-case-from pos="1"><lit v="torrare"/></get-case-from>
                 <lit-tag v="vblex"/>
                 <clip pos="1" side="tl" part="temps"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="gen"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="tags"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
             </mlu>
             <b/>
             <lu>
               <get-case-from pos="3">
               <lit v="a"/>
               </get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <get-case-from pos="3">
               <clip pos="1" side="tl" part="lemh"/>
               </get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: ifi + di nuovo">
       <pattern>
         <pattern-item n="ifi"/>
         <pattern-item n="di_nuovo"/>
       </pattern>
       <action>
         <out>
           <chunk name="ifi_dinuovo">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1"><lit v="àere"/></get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="1" side="tl" part="pers"/>
                 <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2"><lit v="torrare"/></get-case-from>
                 <lit-tag v="vblex.pp.m.sg"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2"><lit v="a"/></get-case-from>
                 <lit-tag v="pr"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2"><clip pos="1" side="tl" part="lemh"/></get-case-from>
                 <clip pos="1" side="tl" part="a_verb"/>
                 <lit-tag v="inf"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: fti + di nuovo">
       <pattern>
         <pattern-item n="fti"/>
         <pattern-item n="di_nuovo"/>
       </pattern>
       <action>
         <out>
           <chunk name="fti-dinuovo">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="àere"/>
               </get-case-from>
               <lit-tag v="vbhaver.pri"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="a"/></get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="torrare"/></get-case-from>
               <lit-tag v="vblex.inf"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="a"/></get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><clip pos="1" side="tl" part="lemh"/></get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: cni + di nuovo">
       <pattern>
         <pattern-item n="cni"/>
         <pattern-item n="di_nuovo"/>
       </pattern>
       <action>
         <out>
           <chunk name="cni-dinuovo">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="dare"/></get-case-from>
               <lit-tag v="vblex.prs"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="gen"/>
               <clip pos="1" side="tl" part="nbr"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="torrare"/></get-case-from>
               <lit-tag v="vblex.inf"/>
             </lu>
             <b/>
             <lu>
               <get-case-from pos="2"><lit v="a"/></get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><clip pos="1" side="tl" part="lemh"/></get-case-from>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: si potere inf > fàghere a + inf">
       <pattern>
         <pattern-item n="si-pro"/>
         <pattern-item n="potere-vbmod-tmp-srd"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <out>
           <chunk name="fàghere_a_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="fàghere"/></get-case-from>
               <lit-tag v="vblex"/>
               <clip pos="2" side="tl" part="temps"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="gen"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><lit v="a"/></get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: pro si potere inf > fàghere a + pro inf">
       <pattern>
         <pattern-item n="pro-pers"/>
         <pattern-item n="si-pro"/>
         <pattern-item n="potere-vbmod-tmp-srd"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <out>
           <chunk name="fàghere_a_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1"><lit v="fàghere"/></get-case-from>
               <lit-tag v="vblex"/>
               <clip pos="3" side="tl" part="temps"/>
               <clip pos="3" side="tl" part="pers"/>
               <clip pos="3" side="tl" part="gen"/>
               <clip pos="3" side="tl" part="nbr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <get-case-from pos="2"><lit v="a"/></get-case-from>
               <lit-tag v="pr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="tags"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: si potere.ifi inf > fàghere a + inf">
       <pattern>
         <pattern-item n="si-pro"/>
         <pattern-item n="potere-vbmod-ifi"/>
         <pattern-item n="inf"/>
       </pattern>
       <action>
         <out>
           <chunk name="fàghere_a_inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
               <lu>
                 <get-case-from pos="1"><lit v="àere"/></get-case-from>
                 <lit-tag v="vbhaver.pii"/>
                 <clip pos="2" side="tl" part="pers"/>
                 <clip pos="2" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                 <get-case-from pos="2"><lit v="fàghere"/></get-case-from>
                 <lit-tag v="vblex"/>
                 <lit-tag v="pp.m.sg"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <get-case-from pos="2"><lit v="a"/></get-case-from>
                 <lit-tag v="pr"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_verb"/>
                 <lit-tag v="inf"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: in n (in albanese > in albanesu)">
       <pattern>
         <pattern-item n="in"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="2" side="sl" part="gen"/><lit-tag v="mf"/></equal>
	         <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
               </and>
             </test>
             <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
           </when>
         </choose>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
	         <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
               </and>
             </test>
             <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
           </when>
         </choose>
         <out>
           <chunk name="in-nom">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: in n adj (in albanese > in albanesu)">
       <pattern>
         <pattern-item n="in"/>
         <pattern-item n="nom"/>
         <pattern-item n="adj"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="3"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="2" side="sl" part="gen"/><lit-tag v="mf"/></equal>
	         <equal><clip pos="3" side="sl" part="gen"/><lit-tag v="mf"/></equal>
	         <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
               </and>
             </test>
             <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="f"/></equal>
                 </test>
                 <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
               </when>
             </choose>
           </when>
         </choose>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
	         <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
	         <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
               </and>
             </test>
             <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </test>
                 <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
               </when>
             </choose>
           </when>
         </choose>
         <out>
           <chunk name="in-nom">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


<!--
    <rule comment="regla: in adj n (in albanese > in albanesu)">
       <pattern>
         <pattern-item n="in"/>
         <pattern-item n="adj"/>
         <pattern-item n="nom"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_reord_adj">
           <with-param pos="3"/>
           <with-param pos="2"/>
         </call-macro>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="3" side="sl" part="gen"/><lit-tag v="mf"/></equal>
	         <equal><clip pos="2" side="sl" part="gen"/><lit-tag v="mf"/></equal>
	         <equal><clip pos="3" side="tl" part="gen"/><lit-tag v="f"/></equal>
               </and>
             </test>
             <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="f"/></equal>
                 </test>
                 <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
               </when>
             </choose>
           </when>
         </choose>
         <choose>
           <when>
             <test>
               <and>
	         <equal><clip pos="3" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
	         <equal><clip pos="2" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
	         <equal><clip pos="3" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
               </and>
             </test>
             <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
             <choose>
               <when>
                 <test>
	           <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="pl"/></equal>
                 </test>
                 <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
               </when>
             </choose>
           </when>
         </choose>
         <out>
           <chunk name="in-nom">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>
-->

<rule comment="regla: circa num nom > unu num nom">
  <pattern>
    <pattern-item n="circa"/>
    <pattern-item n="num"/>
    <pattern-item n="nom_pl_mila"/>
  </pattern>
  <action>
    <call-macro n="f_concord2">
      <with-param pos="3"/>
      <with-param pos="2"/>
    </call-macro>
    <choose>	<!-- needed for e.g. "circa 90.000 KWh" -->
       <when>
         <test>
           <equal><var n="numero"/><lit-tag v="sg"/></equal>
         </test>
         <let><var n="numero"/><lit-tag v="pl"/></let>
       </when>
    </choose>
    <choose>
       <when>
         <test>
           <in caseless="yes"><clip pos="3" side="sl" part="lemh"/><list n="trencats"/></in>
         </test>
         <out>
           <chunk name="det-nom-num">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="unu_num"/>	<!-- to avoid un' -->
               </get-case-from>
               <lit-tag v="det.ind"/>
               <var n="genero"/>
               <var n="numero"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="det-num-n">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
             <lu>
               <get-case-from pos="1">
                 <lit v="unu"/>
               </get-case-from>
               <lit-tag v="det.ind"/>
               <var n="genero"/>
               <var n="numero"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
           </out>
       </otherwise>
    </choose>
   </action>
</rule>


<rule comment="regla: num nom adj > num nom adj">
  <pattern>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="2"/>
      <with-param pos="3"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_clean_post">
      <with-param pos="3"/>
    </call-macro>
    <out>
      <chunk name="num-n-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: det adv num nom > det adv num nom (le circa 150 lingue > sas belle 150 limbas)">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="adv"/>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="4"/>
      <with-param pos="1"/>
      <with-param pos="3"/>
    </call-macro>
    <out>
      <chunk name="det-num-n">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: det adv num nom adj > det adv num nom adj (le circa 150 lingue native > sas belle 150 limbas nadias)">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="adv"/>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord4">
      <with-param pos="4"/>
      <with-param pos="5"/>
      <with-param pos="1"/>
      <with-param pos="3"/>
    </call-macro>
    <out>
      <chunk name="det-num-n-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
        <b pos="4"/>
        <lu>
          <clip pos="5" side="tl" part="lemh"/>
          <clip pos="5" side="tl" part="tags"/>
          <clip pos="5" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<!--
<rule comment="regla: det num nom adj > det num nom adj">
  <pattern>
    <pattern-item n="det"/>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord4">
      <with-param pos="3"/>
      <with-param pos="4"/>
      <with-param pos="1"/>
      <with-param pos="2"/>
    </call-macro>
    <out>
      <chunk name="det-num-n-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>
-->

<rule comment="regla: num adjec nom > num adjec nom">
  <pattern>
    <pattern-item n="num"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_chunk_tags">
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="f_reord_adj">
      <with-param pos="3"/>
      <with-param pos="2"/>
    </call-macro>
    <out>
      <chunk name="num-adj-n">
        <tags>
          <tag><lit-tag v="SN"/></tag>
          <tag><var n="genero_tl"/></tag>
          <tag><var n="numero_tl"/></tag>
          <tag><var n="genero_sl"/></tag>
          <tag><var n="numero_sl"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: num nom adjec adjec > num nom adjec adjec">
  <pattern>
    <pattern-item n="num"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord4">
      <with-param pos="2"/>
      <with-param pos="3"/>
      <with-param pos="4"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_clean_post">
      <with-param pos="3"/>
    </call-macro>
    <call-macro n="f_clean_post">
      <with-param pos="4"/>
    </call-macro>
    <out>
      <chunk name="num-n-adj-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: num adjec nom adjec > num adjec nom adjec">
  <pattern>
    <pattern-item n="num"/>
    <pattern-item n="adjec"/>
    <pattern-item n="nom"/>
    <pattern-item n="adjec"/>
  </pattern>
  <action>
    <call-macro n="f_concord4">
      <with-param pos="3"/>
      <with-param pos="2"/>
      <with-param pos="4"/>
      <with-param pos="1"/>
    </call-macro>
    <call-macro n="f_reord_adj3">
      <with-param pos="3"/>
      <with-param pos="4"/>
      <with-param pos="2"/>
    </call-macro>
    <out>
      <chunk name="num-n-adj-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <clip pos="1" side="tl" part="lemh"/>
          <clip pos="1" side="tl" part="tags"/>
          <clip pos="1" side="tl" part="lemq"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: circa num nom adjec > unos num nom adjec">
  <pattern>
    <pattern-item n="circa"/>
    <pattern-item n="num"/>
    <pattern-item n="nom_pl_mila"/>
    <pattern-item n="adj_pl"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="3"/>
      <with-param pos="4"/>
      <with-param pos="2"/>
    </call-macro>
    <choose>	<!-- needed for e.g. "circa 90.000 KWh" -->
       <when>
         <test>
           <equal><var n="numero"/><lit-tag v="sg"/></equal>
         </test>
         <let><var n="numero"/><lit-tag v="pl"/></let>
       </when>
    </choose>
    <out>
      <chunk name="det-num-n-adj">
        <tags>
          <tag><lit-tag v="SN"/></tag>
        </tags>
        <lu>
          <get-case-from pos="1">
            <lit v="unu"/>
          </get-case-from>
          <lit-tag v="det.ind"/>
          <var n="genero"/>
          <var n="numero"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: circa num adjec nom > unos num adjec nom">
  <pattern>
    <pattern-item n="circa"/>
    <pattern-item n="num"/>
    <pattern-item n="adj_pl"/>
    <pattern-item n="nom_pl"/>
  </pattern>
  <action>
    <call-macro n="f_concord3">
      <with-param pos="4"/>
      <with-param pos="3"/>
      <with-param pos="2"/>
    </call-macro>
    <call-macro n="f_chunk_tags">
      <with-param pos="4"/>
    </call-macro>
    <call-macro n="f_reord_adj">
      <with-param pos="4"/>
      <with-param pos="3"/>
    </call-macro>
    <choose>	<!-- needed for e.g. "circa 90.000 KWh" -->
       <when>
         <test>
           <equal><var n="numero"/><lit-tag v="sg"/></equal>
         </test>
         <let><var n="numero"/><lit-tag v="pl"/></let>
       </when>
    </choose>
    <out>
      <chunk name="det-num-adj-n">
        <tags>
          <tag><lit-tag v="SN"/></tag>
          <tag><var n="genero_tl"/></tag>
          <tag><var n="numero_tl"/></tag>
          <tag><var n="genero_sl"/></tag>
          <tag><var n="numero_sl"/></tag>
        </tags>
        <lu>
          <get-case-from pos="1">
            <lit v="unu"/>
          </get-case-from>
          <lit-tag v="det.ind"/>
          <var n="genero"/>
          <var n="numero"/>
        </lu>
        <b pos="1"/>
        <lu>
          <clip pos="2" side="tl" part="lemh"/>
          <clip pos="2" side="tl" part="tags"/>
          <clip pos="2" side="tl" part="lemq"/>
        </lu>
        <b pos="2"/>
        <lu>
          <clip pos="3" side="tl" part="lemh"/>
          <clip pos="3" side="tl" part="tags"/>
          <clip pos="3" side="tl" part="lemq"/>
        </lu>
        <b pos="3"/>
        <lu>
          <clip pos="4" side="tl" part="lemh"/>
          <clip pos="4" side="tl" part="tags"/>
          <clip pos="4" side="tl" part="lemq"/>
        </lu>
      </chunk>
    </out>
  </action>
</rule>

<rule comment="regla: sent non inf > sent non prs.p2.pl (Non fare così > Non fatzais gasi)">
   <pattern>
     <pattern-item n="sent"/>
     <pattern-item n="non"/>
     <pattern-item n="inf"/>
   </pattern>
   <action>
     <let><var n="genero"/><lit-tag v="m"/></let>
     <let><var n="numero"/><lit-tag v="sg"/></let>
     <choose>
       <when>
         <test>
           <equal><clip pos="3" side="tl" part="a_verb"/><lit-tag v="vbmod"/></equal>
         </test>
         <out>
           <chunk name="sent">
             <tags>
               <tag><lit-tag v="sent"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="non-inf">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="tags"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </when>
       <otherwise>
         <out>
           <chunk name="sent">
             <tags>
               <tag><lit-tag v="sent"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="non-imp">
             <tags>
               <tag><lit-tag v="SV"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <lit-tag v="prs"/>
               <lit-tag v="p2"/>
               <lit-tag v="pl"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </otherwise>
     </choose>
   </action>
</rule>

    <!-- ============================= tractament multiparaules ================================= -->

<rule comment="regla: n">
  <pattern>
    <pattern-item n="nom"/>
  </pattern>
  <action>
    <call-macro n="f_concord1">
      <with-param pos="1"/>
    </call-macro>
     <call-macro n="f_chunk_tags">
       <with-param pos="1"/>
     </call-macro>
    <choose>
      <when>
        <test>
          <in caseless="yes"><clip pos="1" side="sl" part="lemh"/><list n="trencats"/></in>
        </test>
        <modify-case><clip pos="1" side="tl" part="lem"/><lit v="aa"/></modify-case>
        <out>
          <chunk name="det-nom-unu">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="su"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <var n="genero"/>
              <var n="numero"/>
             </lu>
             <b/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b/>
             <lu>
               <lit v="unu_num"/>	<!-- to avoid un' -->
               <lit-tag v="num"/>
               <var n="genero"/>
               <lit-tag v="sp"/>
             </lu>
          </chunk>
        </out>
      </when>
      <otherwise>
        <out>
          <chunk name="nom">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="tags"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </chunk>
        </out>
      </otherwise>
    </choose>
   </action>
</rule>


    <rule comment="regla: NP">
       <pattern>
         <pattern-item n="np"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="np">
             <tags>
               <tag><lit-tag v="SN"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: pp (tractament multiparaules)">
       <pattern>
         <pattern-item n="pp"/>
       </pattern>
       <action>
         <call-macro n="modif_case">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="1" side="tl" part="a_verb"/></tag>
               <tag><clip pos="1" side="tl" part="temps"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_adjec"/>
               <lit-tag v="4"/>
               <lit-tag v="5"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adjec-nopp">
       <pattern>
         <pattern-item n="adjec-nopp"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="adj">
             <tags>
               <tag><lit-tag v="SA"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_adjec"/>
               <lit-tag v="2"/>
               <lit-tag v="3"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: adjsup">
       <pattern>
         <pattern-item n="adjsup"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="1"/>
         </call-macro>
	  <let>
	    <clip pos="1" side="tl" part="a_adj_sup"/>
	    <lit-tag v="adj"/>
	  </let>
         <out>
           <chunk name="adjsup">
             <tags>
               <tag><lit-tag v="SA"/></tag>
               <tag><clip pos="1" side="tl" part="gen"/></tag>
               <tag><clip pos="1" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="a_adjec"/>
             <lit-tag v="2"/>
             <lit-tag v="3"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
           <b/>
           <lu>
               <lit v="meda"/><lit-tag v="adv"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: molto adjec > adjec meda">
       <pattern>
         <pattern-item n="molto_proprio"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adj_meda">
             <tags>
               <tag><lit-tag v="SA"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="a_adjec"/>
             <lit-tag v="2"/>
             <lit-tag v="3"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
               <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: molto adv > adv meda">
       <pattern>
         <pattern-item n="molto_proprio"/>
         <pattern-item n="adv"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <out>
           <chunk name="adv_meda">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="tags"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <get-case-from pos="2">
               <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: molto adjec cnjcoo adjec > adjec cnjcoo adjec meda">
       <pattern>
         <pattern-item n="molto_proprio"/>
         <pattern-item n="adjec"/>
         <pattern-item n="cnjcoo"/>
         <pattern-item n="adjec"/>
       </pattern>
       <action>
         <call-macro n="f_concord2">
           <with-param pos="2"/>
           <with-param pos="4"/>
         </call-macro>
         <call-macro n="f_chunk_tags">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="2"/>
         </call-macro>
         <call-macro n="f_clean_post">
           <with-param pos="4"/>
         </call-macro>
         <out>
           <chunk name="adj_meda">
             <tags>
               <tag><lit-tag v="SA"/></tag>
               <tag><clip pos="2" side="tl" part="gen"/></tag>
               <tag><clip pos="2" side="tl" part="nbr"/></tag>
               <tag><var n="genero_sl"/></tag>
               <tag><var n="numero_sl"/></tag>
             </tags>
           <lu>
             <get-case-from pos="1">
               <clip pos="2" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="2" side="tl" part="a_adjec"/>
             <lit-tag v="2"/>
             <lit-tag v="3"/>
             <clip pos="2" side="tl" part="lemq"/>
           </lu>
           <b pos="1"/>
           <lu>
             <clip pos="3" side="tl" part="whole"/>
           </lu>
           <b pos="2"/>
           <lu>
             <clip pos="4" side="tl" part="lemh"/>
             <clip pos="4" side="tl" part="tags"/>
             <clip pos="4" side="tl" part="lemq"/>
           </lu>
           <b pos="3"/>
           <lu>
             <get-case-from pos="2">
               <clip pos="1" side="tl" part="lemh"/>
             </get-case-from>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: pro">
       <pattern>
         <pattern-item n="pro"/>
       </pattern>
       <action>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
         <out>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: prn">
       <pattern>
         <pattern-item n="prn"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="prn">
             <tags>
               <tag><lit-tag v="SN"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: predet">
       <pattern>
         <pattern-item n="predet"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="predet">
             <tags>
               <tag><lit-tag v="Sdet"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: det">
       <pattern>
         <pattern-item n="det"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <call-macro n="modif_case">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="d">
             <tags>
               <tag><lit-tag v="Sdet"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: num">
       <pattern>
         <pattern-item n="num"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="num">
             <tags>
               <tag><lit-tag v="SNum"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: verb (tractament multiparaules)">
       <pattern>
         <pattern-item n="verb"/>
       </pattern>
       <action>
         <call-macro n="modif_case">
           <with-param pos="1"/>
         </call-macro>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="SV"/></tag>
               <tag><clip pos="1" side="tl" part="a_verb"/></tag>
               <tag><clip pos="1" side="tl" part="temps"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: adverb (tractament multiparaules)">
       <pattern>
         <pattern-item n="adv-preadv"/>
       </pattern>
       <action>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="SAdv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>


    <rule comment="regla: relatiu (tractament multiparaules)">
       <pattern>
         <pattern-item n="rel"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="1"/>
         </call-macro>
         <out>
           <chunk name="rel">
             <tags>
               <tag><lit-tag v="rel"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: cnjsub">
       <pattern>
         <pattern-item n="cnjsub"/>
       </pattern>
       <action>
         <out>
           <chunk name="cnjsub">
             <tags>
               <tag><lit-tag v="cnjsub"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: cnjcoo">
       <pattern>
         <pattern-item n="cnjcoo"/>
       </pattern>
       <action>
         <out>
           <chunk name="cnjcoo">
             <tags>
               <tag><lit-tag v="cnjcoo"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: cnjadv">
       <pattern>
         <pattern-item n="cnjadv"/>
       </pattern>
       <action>
         <out>
           <chunk name="cnjadv">
             <tags>
               <tag><lit-tag v="cnjadv"/></tag>
             </tags>
           <lu>
             <clip pos="1" side="tl" part="lemh"/>
             <clip pos="1" side="tl" part="tags"/>
             <clip pos="1" side="tl" part="lemq"/>
           </lu>
         </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: pr">
       <pattern>
         <pattern-item n="pr"/>
       </pattern>
       <action>
         <!-- per evitare: condizioni di navigabilità > cunditziones de navigabilidades -->
         <let><var n="genero"/><lit-tag v="m"/></let>
         <let><var n="numero"/><lit-tag v="sg"/></let>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="pr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: pr rel">
       <pattern>
         <pattern-item n="pr"/>
         <pattern-item n="rel"/>
       </pattern>
       <action>
         <call-macro n="f_concord1">
           <with-param pos="2"/>
         </call-macro>
         <let><var n="chunkname"/><clip pos="1" side="tl" part="lem"/></let>
         <out>
           <chunk namefrom="chunkname">
             <tags>
               <tag><lit-tag v="pr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="tags"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
           <b pos="1"/>
           <chunk name="rel">
             <tags>
               <tag><lit-tag v="rel"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="tags"/>
               <clip pos="2" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: cm">
       <pattern>
         <pattern-item n="cm"/>
       </pattern>
       <action>
         <out>
           <chunk name="cm">
             <tags>
               <tag><lit-tag v="cm"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

    <rule comment="regla: sent">
       <pattern>
         <pattern-item n="sent"/>
       </pattern>
       <action>
	 <let><var n="genero"/><lit-tag v="m"/></let>
	 <let><var n="numero"/><lit-tag v="sg"/></let>
         <out>
           <chunk name="sent">
             <tags>
               <tag><lit-tag v="sent"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
       </action>
    </rule>

</section-rules>

</transfer>
